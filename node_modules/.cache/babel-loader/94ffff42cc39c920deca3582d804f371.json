{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\Admin\\\\NodeProjects\\\\DeathDate\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\Admin\\\\NodeProjects\\\\DeathDate\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:\\\\Users\\\\Admin\\\\NodeProjects\\\\DeathDate\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\Admin\\\\NodeProjects\\\\DeathDate\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"C:\\\\Users\\\\Admin\\\\NodeProjects\\\\DeathDate\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"C:\\\\Users\\\\Admin\\\\NodeProjects\\\\DeathDate\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"C:\\\\Users\\\\Admin\\\\NodeProjects\\\\DeathDate\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:\\\\Users\\\\Admin\\\\NodeProjects\\\\DeathDate\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import React from'react';import bridge from'@vkontakte/vk-bridge';import'@vkontakte/vkui/dist/vkui.css';import'./css/App.css';import eruda from'eruda';import html2canvas from'html2canvas';import{Div,Panel,Title,Headline,View,FixedLayout,Button,ScreenSpinner,platform}from'@vkontakte/vkui';import Icon28StoryOutline from'@vkontakte/icons/dist/28/story_outline';import Icon24ImageFilterOutline from'@vkontakte/icons/dist/24/image_filter_outline';var blueBackground={backgroundColor:'var(--accent)'},redBackground={backgroundColor:'var(--dynamic_red)'},os=platform();var App=/*#__PURE__*/function(_React$Component){_inherits(App,_React$Component);function App(props){var _this;_classCallCheck(this,App);_this=_possibleConstructorReturn(this,_getPrototypeOf(App).call(this,props));_this.back=function(){if(_this.state.popout!==null){_this.setState({popout:null});return;}var _this$state=_this.state,activePanel=_this$state.activePanel,history=_this$state.history;if(activePanel==='main'){bridge.send('VKWebAppClose',{status:'success'});}else{if(history.length===1){bridge.send('VKWebAppClose',{status:'success'});}else if(history.length>1){history.pop();activePanel=history[history.length-1];_this.setState({activePanel:activePanel});_this.change_hash(activePanel);}}};_this.state={popout:null,history:['main'],activePanel:'main',time:'',screen:false,scheme:'bright_light',paralel:false};_this.componentDidMount=_this.componentDidMount.bind(_assertThisInitialized(_this));_this.initializeApp=_this.initializeApp.bind(_assertThisInitialized(_this));_this.back=_this.back.bind(_assertThisInitialized(_this));_this.go=_this.go.bind(_assertThisInitialized(_this));_this.change_hash=_this.change_hash.bind(_assertThisInitialized(_this));_this.generateRandomTime=_this.generateRandomTime.bind(_assertThisInitialized(_this));_this.updateTime=_this.updateTime.bind(_assertThisInitialized(_this));eruda.init();return _this;}_createClass(App,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _this2=this;var generated;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return this.generateRandomTime(false);case 2:generated=_context2.sent;this.updateTime();window.addEventListener('popstate',function(e){e.preventDefault();_this2.back(e);});bridge.subscribe(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref){var _ref$detail,type,data,schemeAttribute,shapes,_iteratorNormalCompletion,_didIteratorError,_iteratorError,_iterator,_step,element;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_ref$detail=_ref.detail,type=_ref$detail.type,data=_ref$detail.data;if(type!==undefined)console.log(type,data);if(!(type==='VKWebAppUpdateConfig')){_context.next=10;break;}schemeAttribute=document.createAttribute('scheme');schemeAttribute.value=false?data.scheme?data.scheme:'bright_light':'space_gray';document.body.attributes.setNamedItem(schemeAttribute);_this2.setState({scheme:schemeAttribute.value});bridge.send('VKWebAppSetViewSettings',{status_bar_style:'dark',action_bar_color:'none'});_context.next=32;break;case 10:if(!(type==='VKWebAppViewRestore')){_context.next=32;break;}_this2.setState({popout:null,screen:false});shapes=document.getElementsByClassName('bg_shape_container');_iteratorNormalCompletion=true;_didIteratorError=false;_iteratorError=undefined;_context.prev=16;for(_iterator=shapes[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){element=_step.value;try{console.log('delete',element);element.delete();}catch(e){console.error(e);}}_context.next=24;break;case 20:_context.prev=20;_context.t0=_context[\"catch\"](16);_didIteratorError=true;_iteratorError=_context.t0;case 24:_context.prev=24;_context.prev=25;if(!_iteratorNormalCompletion&&_iterator.return!=null){_iterator.return();}case 27:_context.prev=27;if(!_didIteratorError){_context.next=30;break;}throw _iteratorError;case 30:return _context.finish(27);case 31:return _context.finish(24);case 32:case\"end\":return _context.stop();}}},_callee,null,[[16,20,24,32],[25,,27,31]]);}));return function(_x){return _ref2.apply(this,arguments);};}());this.initializeApp();case 7:case\"end\":return _context2.stop();}}},_callee2,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"initializeApp\",value:function initializeApp(){var _this3=this;var hash=window.location.hash;if(hash){hash=hash.replace('#','');this.go(hash);}else{this.change_hash('main');}var imgs=['https://image.flaticon.com/icons/svg/2893/2893113.svg','https://image.flaticon.com/icons/svg/2893/2893195.svg'];var bgInterval=setInterval(function(){var shape_container=document.createElement('div');shape_container.className='bg_shape_container';var shape=document.createElement('img');shape.className='bg_shape light_outline';shape.src=imgs[_this3.random(0,imgs.length)];shape.style.left=_this3.random(-15,90)+'vw';shape_container.appendChild(shape);document.getElementById('bg_shapes').appendChild(shape_container);for(var i=0;i<5;i++){shape.style.setProperty('--offset-x-'+i,_this3.random(-20,20)+'vw');}setTimeout(function(){try{shape_container.remove();}catch(e){}},10000);},600);bridge.send('VKWebAppInit');}},{key:\"generateRandomTime\",value:function(){var _generateRandomTime=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(isParalel){var timeDate,reasons;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return new Date(Date.now()+this.random(1*60*60*1000,100*365*24*60*60*1000));case 2:timeDate=_context3.sent;reasons=['голода','жажды','диеты','нехватки кислорода'];if(this.state.reason2){_context3.next=16;break;}if(!isParalel){_context3.next=12;break;}_context3.next=8;return this.setState({reason2:reasons[this.random(0,reasons.length)]});case 8:_context3.next=10;return this.setState({timeDate2:timeDate});case 10:_context3.next=16;break;case 12:_context3.next=14;return this.setState({reason:reasons[this.random(0,reasons.length)]});case 14:_context3.next=16;return this.setState({timeDate:timeDate});case 16:_context3.next=18;return this.setState({paralel:isParalel});case 18:return _context3.abrupt(\"return\",true);case 19:case\"end\":return _context3.stop();}}},_callee3,this);}));function generateRandomTime(_x2){return _generateRandomTime.apply(this,arguments);}return generateRandomTime;}()},{key:\"updateTime\",value:function updateTime(){var _this4=this;setInterval(function(){try{var timeMs=(_this4.state.paralel?_this4.state.timeDate2.getTime():_this4.state.timeDate.getTime())-Date.now();var years,days,hours,minutes,seconds;var yMs=1000*60*60*24*365,dMs=yMs/365,hMs=dMs/24,minMs=hMs/60,sMs=minMs/60;years=Math.floor(timeMs/yMs);timeMs-=yMs;days=Math.floor(timeMs/dMs)%365;timeMs-=dMs;hours=Math.floor(timeMs/hMs)%24;timeMs-=hMs;minutes=Math.floor(timeMs/minMs)%60;timeMs-=minMs;seconds=Math.floor(timeMs/sMs)%60;timeMs-=sMs;var times=[[years,'лет'],[days,'дней'],[hours,'ч.'],[minutes,'мин.'],[seconds,'сек.']],timesText=[];for(var i=0;i<times.length;i++){if(times[i][0]>0)timesText.push(times[i][0]+' '+times[i][1]);}_this4.setState({time:timesText.join(', ')});}catch(e){console.error(e);}},500);}},{key:\"go\",value:function go(panel){var history=this.state.history;if(history[history.length-1]!==panel){history.push(panel);window.history.pushState({activePanel:panel},'Title');this.setState({activePanel:panel,history:history,snackbar:null});}this.change_hash(panel);}},{key:\"change_hash\",value:function change_hash(panel){bridge.send(\"VKWebAppSetLocation\",{\"location\":panel});}},{key:\"sleep\",value:function sleep(ms){return new Promise(function(resolve){return setTimeout(resolve,ms);});}},{key:\"random\",value:function random(min,max){return Math.floor(Math.random()*(max-min)+min);}},{key:\"render\",value:function render(){var _this5=this;return React.createElement(View,{activePanel:this.state.activePanel,popout:this.state.popout,history:this.state.history,onSwipeBack:this.back},React.createElement(Panel,{id:\"main\",style:{height:'100vh',width:'100vw'}},React.createElement(\"div\",{id:\"bg_shapes\"}),React.createElement(\"div\",{style:{position:'absolute',top:'50%',left:'50%',transform:'translate(-50%, -50%)',width:'80vw',textAlign:'center',paddingBottom:''}},React.createElement(Title,{level:\"1\",weight:\"semibold\"},\"\\u041C\\u043D\\u0435 \\u043E\\u0441\\u0442\\u0430\\u043B\\u043E\\u0441\\u044C \",React.createElement(\"span\",{style:{backgroundImage:'linear-gradient(to left, #fc6076 0%, #ff9a44 100%)',color:'white',lineHeight:'18px',padding:'4px 4px 8px 4px',display:'inline-block'}},\"\\u0436\\u0438\\u0442\\u044C\")),React.createElement(Title,{level:\"2\",weight:\"semibold\",style:{marginTop:'12px'}},this.state.time),React.createElement(Headline,{weight:\"semibold\",style:{marginTop:'12px',color:'white',background:'linear-gradient(to right, #ed6ea0 0%, #ec8c69 100%)',padding:'4px',display:'inline-block'}},'Я умру из-за '+(this.state.paralel?this.state.reason2:this.state.reason)),React.createElement(\"br\",null),React.createElement(Button,{before:React.createElement(Icon24ImageFilterOutline,{width:20,height:20,style:{paddingRight:'4px'}}),size:\"l\",style:{marginTop:'12px',display:this.state.screen&&'none'},onClick:/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return _this5.generateRandomTime(!_this5.state.paralel);case 2:case\"end\":return _context4.stop();}}},_callee4);}))},this.state.paralel?'Вернуться':'Паралельная вселенная')),React.createElement(FixedLayout,{vertical:\"bottom\",style:{marginBottom:'12px',display:this.state.screen&&'none'}},React.createElement(Div,null,React.createElement(Button,{onClick:/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_this5.setState({popout:React.createElement(ScreenSpinner,null),screen:true});_context6.next=3;return _this5.sleep(250);case 3:html2canvas(document.getElementsByClassName('View__panels')[0]).then(/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(canvas){var blob;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:blob=canvas.toDataURL('image/png');_context5.prev=1;_context5.next=4;return bridge.send('VKWebAppShowStoryBox',{background_type:'image',blob:blob});case 4:_context5.next=8;break;case 6:_context5.prev=6;_context5.t0=_context5[\"catch\"](1);case 8:_this5.setState({popout:null,screen:false});case 9:case\"end\":return _context5.stop();}}},_callee5,null,[[1,6]]);}));return function(_x3){return _ref5.apply(this,arguments);};}());case 4:case\"end\":return _context6.stop();}}},_callee6);})),before:React.createElement(Icon28StoryOutline,null),size:\"xl\",mode:\"commerce\"},\"\\u041F\\u043E\\u0434\\u0435\\u043B\\u0438\\u0442\\u044C\\u0441\\u044F \\u0432 \\u0438\\u0441\\u0442\\u043E\\u0440\\u0438\\u0438\")))));}}]);return App;}(React.Component);export default App;","map":null,"metadata":{},"sourceType":"module"}