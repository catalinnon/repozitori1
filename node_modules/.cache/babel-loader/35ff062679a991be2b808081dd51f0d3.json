{"ast":null,"code":"import _classCallCheck from\"C:\\\\Users\\\\Admin\\\\Desktop\\\\\\u041F\\u0440\\u043E\\u0435\\u043A\\u0442\\u044B\\\\NodeJS\\\\TestVKMiniApp\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\Admin\\\\Desktop\\\\\\u041F\\u0440\\u043E\\u0435\\u043A\\u0442\\u044B\\\\NodeJS\\\\TestVKMiniApp\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"C:\\\\Users\\\\Admin\\\\Desktop\\\\\\u041F\\u0440\\u043E\\u0435\\u043A\\u0442\\u044B\\\\NodeJS\\\\TestVKMiniApp\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"C:\\\\Users\\\\Admin\\\\Desktop\\\\\\u041F\\u0440\\u043E\\u0435\\u043A\\u0442\\u044B\\\\NodeJS\\\\TestVKMiniApp\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"C:\\\\Users\\\\Admin\\\\Desktop\\\\\\u041F\\u0440\\u043E\\u0435\\u043A\\u0442\\u044B\\\\NodeJS\\\\TestVKMiniApp\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:\\\\Users\\\\Admin\\\\Desktop\\\\\\u041F\\u0440\\u043E\\u0435\\u043A\\u0442\\u044B\\\\NodeJS\\\\TestVKMiniApp\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import React from'react';import{platform,IOS}from'@vkontakte/vkui';import Panel from'@vkontakte/vkui/dist/components/Panel/Panel';import PanelHeader from'@vkontakte/vkui/dist/components/PanelHeader/PanelHeader';import HeaderButton from'@vkontakte/vkui/dist/components/HeaderButton/HeaderButton';import Icon28ChevronBack from'@vkontakte/icons/dist/28/chevron_back';import Icon24Back from'@vkontakte/icons/dist/24/back';import Snackbar from'@vkontakte/vkui/dist/components/Snackbar/Snackbar';import CellButton from'@vkontakte/vkui/dist/components/CellButton/CellButton';import Group from'@vkontakte/vkui/dist/components/Group/Group';import Div from'@vkontakte/vkui/dist/components/Div/Div';import Avatar from'@vkontakte/vkui/dist/components/Avatar/Avatar';import View from'@vkontakte/vkui/dist/components/View/View';import Icon16Done from'@vkontakte/icons/dist/16/done';import axios from'axios';import connect from'@vkontakte/vk-connect';var osName=platform();var blueBackground={backgroundColor:'var(--accent)'};var Server=/*#__PURE__*/function(_React$Component){_inherits(Server,_React$Component);function Server(props){var _this;_classCallCheck(this,Server);_this=_possibleConstructorReturn(this,_getPrototypeOf(Server).call(this,props));_this.state={text:'',snackbar:null};_this.openBase=_this.openBase.bind(_assertThisInitialized(_this));_this.connect=_this.connect.bind(_assertThisInitialized(_this));return _this;}_createClass(Server,[{key:\"componentDidMount\",value:function componentDidMount(){connect.send(\"VKWebAppInit\",{});var adapter={send:function send(handler,data){if(handler==='VKWebAppGetAuthToken'){log(\"[EVENT DISPATCHED] VKWebAppGetAuthToken: \".concat(JSON.stringify(data)));event=new CustomEvent('VKWebAppEvent',{detail:{type:'VKWebAppAccessTokenReceived',data:{'authentication_token':\"\".concat(data.app_id).concat(data.scope)}}});window.dispatchEvent(event);}}};var connect=new ReactiveVkconnect.VkConnect(window,adapter);var GetAuthTokenResponse=connect.events.pipe(// restricts only specified events\nfilter(function(event){return event.type==='VKWebAppAccessTokenReceived'||'VKWebAppAccessTokenFailed';}),// extract data from event\nmap(function(event){var _event$detail=event.detail,type=_event$detail.type,data=_event$detail.data;if(type==='VKWebAppAccessTokenReceived')return{name:type,data:data};else throw{name:type,data:data};}),// unsubscribe when first data received\ntake(1));GetAuthTokenResponse.subscribe(function(event){return log(\"[SUCCESS] \".concat(event.name,\": \").concat(JSON.stringify(event.data)));},function(event){return log(\"[ERROR] \".concat(event.name,\": \").concat(JSON.stringify(event.data)));},function(){return log('[COMPLETE]');});connect.send(\"VKWebAppGetAuthToken\",{\"app_id\":7208944,\"scope\":\"messages,groups,friends,offline\"});}},{key:\"connect\",value:function connect(){axios({method:'get',url:\"https://admin-chat-bot.herokuapp.com/api\",headers:{'Content-Type':'application/json'},responseType:'json'}).then(function(response){this.setState({text:response.data.data});}.bind(this));}},{key:\"invite\",value:function invite(){connect.sendPromise(\"VKWebAppCallAPIMethod\",{\"method\":\"users.get\",\"params\":{\"v\":\"5.68\"}}).then(function(data){console.log(data);}).catch(function(error){console.log(error);});}},{key:\"openBase\",value:function openBase(){var _this2=this;if(this.state.snackbar)return;this.setState({snackbar:React.createElement(Snackbar,{layout:\"vertical\",onClose:function onClose(){return _this2.setState({snackbar:null});},before:React.createElement(Avatar,{size:24,style:blueBackground},React.createElement(Icon16Done,{fill:\"#fff\",width:14,height:14}))},\"This is snack bar\")});}},{key:\"render\",value:function render(){var props=this.props;return React.createElement(Panel,{id:props.id},React.createElement(PanelHeader,{left:React.createElement(HeaderButton,{onClick:props.go,\"data-to\":\"home\"},osName===IOS?React.createElement(Icon28ChevronBack,null):React.createElement(Icon24Back,null))},\"Server\"),React.createElement(Group,null,React.createElement(CellButton,{onClick:this.openBase},\"Snackbar\"),React.createElement(CellButton,{onClick:this.connect},\"Try to connect\"),React.createElement(CellButton,{onClick:this.invite},\"Invite bot\")),this.state.text&&React.createElement(Group,null,React.createElement(Div,null,this.state.text)),React.createElement(Group,null,\" \",React.createElement(Div,null,\"1.78\"),\" \"),this.state.snackbar);}}]);return Server;}(React.Component);export default Server;","map":{"version":3,"sources":["C:/Users/Admin/Desktop/Проекты/NodeJS/TestVKMiniApp/src/panels/Server.js"],"names":["React","platform","IOS","Panel","PanelHeader","HeaderButton","Icon28ChevronBack","Icon24Back","Snackbar","CellButton","Group","Div","Avatar","View","Icon16Done","axios","connect","osName","blueBackground","backgroundColor","Server","props","state","text","snackbar","openBase","bind","send","adapter","handler","data","log","JSON","stringify","event","CustomEvent","detail","type","app_id","scope","window","dispatchEvent","ReactiveVkconnect","VkConnect","GetAuthTokenResponse","events","pipe","filter","map","name","take","subscribe","method","url","headers","responseType","then","response","setState","sendPromise","console","catch","error","id","go","invite","Component"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { platform, IOS } from '@vkontakte/vkui';\r\nimport Panel from '@vkontakte/vkui/dist/components/Panel/Panel';\r\nimport PanelHeader from '@vkontakte/vkui/dist/components/PanelHeader/PanelHeader';\r\nimport HeaderButton from '@vkontakte/vkui/dist/components/HeaderButton/HeaderButton';\r\nimport Icon28ChevronBack from '@vkontakte/icons/dist/28/chevron_back';\r\nimport Icon24Back from '@vkontakte/icons/dist/24/back';\r\n\r\nimport Snackbar from '@vkontakte/vkui/dist/components/Snackbar/Snackbar';\r\nimport CellButton from '@vkontakte/vkui/dist/components/CellButton/CellButton';\r\nimport Group from '@vkontakte/vkui/dist/components/Group/Group';\r\nimport Div from '@vkontakte/vkui/dist/components/Div/Div';\r\nimport Avatar from '@vkontakte/vkui/dist/components/Avatar/Avatar';\r\nimport View from '@vkontakte/vkui/dist/components/View/View';\r\n\r\nimport Icon16Done from '@vkontakte/icons/dist/16/done';\r\nimport axios from 'axios';\r\nimport connect from '@vkontakte/vk-connect';\r\n\r\nconst osName = platform();\r\n\r\nconst blueBackground = {\r\n  backgroundColor: 'var(--accent)'\r\n};\r\n\r\nclass Server extends React.Component {\r\n\t\r\n\tstate = {\r\n\t\ttext: '',\r\n\t\tsnackbar: null\r\n\t};\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\r\n\t\tthis.openBase = this.openBase.bind(this);\r\n\t\tthis.connect = this.connect.bind(this);\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tconnect.send(\"VKWebAppInit\", {});\r\n\t\tvar adapter = {\r\n\t\t  send: (handler, data) => {\r\n\t\t\tif (handler === 'VKWebAppGetAuthToken' ){\r\n\t\t\t  log(`[EVENT DISPATCHED] VKWebAppGetAuthToken: ${JSON.stringify(data)}`);\r\n\t\t\t  event = new CustomEvent('VKWebAppEvent', {\r\n\t\t\t\tdetail: {\r\n\t\t\t\t  type: 'VKWebAppAccessTokenReceived',\r\n\t\t\t\t  data: {'authentication_token': `${data.app_id}${data.scope}`}\r\n\t\t\t\t}\r\n\t\t\t  });\r\n\t\t\t  window.dispatchEvent(event);\r\n\t\t\t}\r\n\t\t  }\r\n\t\t};\r\n\t\tvar connect = new ReactiveVkconnect.VkConnect(window, adapter);\r\n\t\tvar  GetAuthTokenResponse = connect.events\r\n\t\t  .pipe(\r\n\t\t\t// restricts only specified events\r\n\t\t\tfilter(event =>\r\n\t\t\t  event.type === 'VKWebAppAccessTokenReceived' ||\r\n\t\t\t  'VKWebAppAccessTokenFailed'\r\n\t\t\t),\r\n\t\t\t// extract data from event\r\n\t\t\tmap(event => {\r\n\t\t\t  var {type, data} = event.detail;\r\n\t\t\t  if (type === 'VKWebAppAccessTokenReceived') return {name: type, data};\r\n\t\t\t  else throw {name: type, data};\r\n\t\t\t}),\r\n\t\t\t// unsubscribe when first data received\r\n\t\t\ttake(1)\r\n\t\t  );\r\n\r\n\t\tGetAuthTokenResponse.subscribe(\r\n\t\t  event => log(`[SUCCESS] ${event.name}: ${JSON.stringify(event.data)}`),\r\n\t\t  event => log(`[ERROR] ${event.name}: ${JSON.stringify(event.data)}`),\r\n\t\t  () => log('[COMPLETE]')\r\n\t\t);\r\n\t\tconnect.send(\"VKWebAppGetAuthToken\", {\"app_id\": 7208944, \"scope\": \"messages,groups,friends,offline\"});\r\n\t}\r\n\r\n\tconnect () {\r\n\t\taxios({\r\n\t\t\tmethod: 'get',\r\n\t\t\turl: \"https://admin-chat-bot.herokuapp.com/api\",\r\n\t\t\theaders: {'Content-Type': 'application/json'},\r\n\t\t\tresponseType: 'json'\r\n\t\t}).then(function (response) {\r\n\t\t\tthis.setState({ text : response.data.data });\r\n\t\t}.bind(this));\r\n\t} \r\n\t\r\n\tinvite () {\r\n\t\t\r\n\t\tconnect.sendPromise(\"VKWebAppCallAPIMethod\", {\r\n\t\t\t\"method\": \"users.get\",\r\n\t\t\t\"params\": {\r\n\t\t\t\t\"v\":\"5.68\"\r\n\t\t\t}\r\n\t\t})\r\n\t\t.then(data => {\r\n\t\t\tconsole.log(data);\r\n\t\t})\r\n\t\t.catch(error => {\r\n\t\t\tconsole.log(error);\r\n\t\t});\r\n\t}\r\n\r\n\topenBase () {\r\n\t\tif (this.state.snackbar) return;\r\n\t\tthis.setState({ snackbar:\r\n\t\t<Snackbar\r\n\t\t\tlayout=\"vertical\"\r\n\t\t\tonClose={() => this.setState({ snackbar: null })}\r\n\t\t\tbefore={<Avatar size={24} style={blueBackground}><Icon16Done fill=\"#fff\" width={14} height={14} /></Avatar>}\r\n\t\t>\r\n\t\t\tThis is snack bar\r\n\t\t</Snackbar>\r\n\t\t});\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst props = this.props;\r\n\t\treturn (\r\n\t\t\t<Panel id={props.id}>\r\n\t\t\t\t<PanelHeader\r\n\t\t\t\t\tleft={<HeaderButton onClick={props.go} data-to=\"home\">\r\n\t\t\t\t\t\t{osName === IOS ? <Icon28ChevronBack/> : <Icon24Back/>}\r\n\t\t\t\t\t</HeaderButton>}\r\n\t\t\t\t>\r\n\t\t\t\t\tServer\r\n\t\t\t\t</PanelHeader>\r\n\t\t\t\r\n\t\t\t\t<Group>\r\n\t\t\t\t<CellButton onClick={this.openBase}>Snackbar</CellButton>\r\n\t\t\t\t<CellButton onClick={this.connect}>Try to connect</CellButton>\r\n\t\t\t\t<CellButton onClick={this.invite}>Invite bot</CellButton>\r\n\t\t\t\t</Group>\r\n\t\t\t\t\r\n\t\t\t\t{this.state.text && <Group><Div>{this.state.text}</Div></Group>}\r\n\t\t\t\t<Group> <Div>1.78</Div> </Group>\r\n\t\r\n\t\t\t\t{this.state.snackbar}\r\n\t\t\t</Panel>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nServer.propTypes = {\r\n\tid: PropTypes.string.isRequired,\r\n\tgo: PropTypes.func.isRequired,\r\n};\r\n\r\nexport default Server;"]},"metadata":{},"sourceType":"module"}