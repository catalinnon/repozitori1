{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\Admin\\\\NodeProjects\\\\VKStickers2\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\Admin\\\\NodeProjects\\\\VKStickers2\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"C:\\\\Users\\\\Admin\\\\NodeProjects\\\\VKStickers2\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _classCallCheck from\"C:\\\\Users\\\\Admin\\\\NodeProjects\\\\VKStickers2\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\Admin\\\\NodeProjects\\\\VKStickers2\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"C:\\\\Users\\\\Admin\\\\NodeProjects\\\\VKStickers2\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"C:\\\\Users\\\\Admin\\\\NodeProjects\\\\VKStickers2\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"C:\\\\Users\\\\Admin\\\\NodeProjects\\\\VKStickers2\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:\\\\Users\\\\Admin\\\\NodeProjects\\\\VKStickers2\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import React from'react';import bridge from'@vkontakte/vk-bridge';import'@vkontakte/vkui/dist/vkui.css';import'./css/App.css';import{Panel,PanelHeader,Div,View,ScreenSpinner,List,Cell,Gallery,FormLayout,Input,Avatar,Group,Epic,Tabbar,TabbarItem,Separator,Button,PanelHeaderContext,Header,PanelHeaderSimple,PanelHeaderContent,Placeholder,Tabs,TabsItem,PullToRefresh}from'@vkontakte/vkui';import Icon16Dropdown from'@vkontakte/icons/dist/16/dropdown';import Icon16Down from'@vkontakte/icons/dist/16/down';import Icon16Up from'@vkontakte/icons/dist/16/up';import Icon28HistoryForwardOutline from'@vkontakte/icons/dist/28/history_forward_outline';import Icon28MarketOutline from'@vkontakte/icons/dist/28/market_outline';import Icon28UserOutline from'@vkontakte/icons/dist/28/user_outline';import Icon56HistoryOutline from'@vkontakte/icons/dist/56/history_outline';import{StickerImg}from\"./components/StickerImg\";import{StickerButton}from\"./components/StickerButton\";import{StickerDescription}from\"./components/StickerDescription\";import{StickerGrid}from\"./components/StickerGrid\";import{StickerUploadButton}from\"./components/StickerUploadButton\";var access_token='',upload_url='';var App=/*#__PURE__*/function(_React$Component){_inherits(App,_React$Component);function App(props){var _this;_classCallCheck(this,App);_this=_possibleConstructorReturn(this,_getPrototypeOf(App).call(this,props));_this.back=function(){var activeStory=_this.state.activeStory;var activePanel=activeStory==='tab_main'?_this.state.activePanelShop:activeStory==='tab_other'?_this.state.activePanelOther:'';var panel_to_change=activeStory==='tab_main'?'activePanelShop':activeStory==='tab_other'?'activePanelOther':'';if(activeStory==='tab_main'&&activePanel==='main'||activeStory==='tab_other'&&activePanel==='profile'){bridge.send(\"VKWebAppClose\",{\"status\":\"success\"});}else{var history=activeStory==='tab_main'?_this.state.historyShop:activeStory==='tab_other'?_this.state.historyOther:'';if(history.length===1){bridge.send(\"VKWebAppClose\",{\"status\":\"success\"});}else if(history.length>1){history.pop();var p=history[history.length-1];_this.setState(_defineProperty({},panel_to_change,p));}}};_this.state={initialized:false,popout:React.createElement(ScreenSpinner,null),activeStory:'tab_main',slideTabIndex:0,activePanelShop:\"main\",historyShop:[\"main\"],activePanelOther:\"profile\",historyOther:[\"profile\"],createStickerContextOpened:false,balance_manipulation:false,stickers:[{title:\"Бисквит\",author:\"Ирина Брэдкэт\",preview:\"https://vk.com/sticker/2-533-cover-140b-0\",price:1,description:\"Хвост торчком, большие ушки —\\nБерегитесь, печенюшки!\",stickers:['https://vk.com/sticker/1-18945-64','https://vk.com/sticker/1-18946-64','https://vk.com/sticker/1-18947-64','https://vk.com/sticker/1-18948-64','https://vk.com/sticker/1-18949-64','https://vk.com/sticker/1-18950-64','https://vk.com/sticker/1-18951-64','https://vk.com/sticker/1-18952-64']},{title:\"Илай\",author:\"Ирина Брэдкэт\",preview:\"https://vk.com/sticker/1-18781-128\",price:1,description:\"Вышел мишка из берлоги — поселился в диалоге.\",stickers:['https://vk.com/sticker/1-18781-128','https://vk.com/sticker/1-18782-128','https://vk.com/sticker/1-18783-128','https://vk.com/sticker/1-18784-128','https://vk.com/sticker/1-18785-128','https://vk.com/sticker/1-18786-128','https://vk.com/sticker/1-18787-128','https://vk.com/sticker/1-18788-128']}],stickers_panel:null,sticker_info:{title:\"\",author:\"\",preview:\"\",price:0,description:\"\",stickers:[]},user:{first_name:'',last_name:'',photo_100:'',stickers:[],balance:0,stickers_history:[]},create_panel:{title:\"\",preview:\"\",price:1,description:\"\",stickers:[]}};_this.onStoryChange=_this.onStoryChange.bind(_assertThisInitialized(_this));_this.onChange=_this.onChange.bind(_assertThisInitialized(_this));_this.uploadFile=_this.uploadFile.bind(_assertThisInitialized(_this));_this.toggleCreateStickerContext=_this.toggleCreateStickerContext.bind(_assertThisInitialized(_this));_this.sync=_this.sync.bind(_assertThisInitialized(_this));_this.componentDidMount=_this.componentDidMount.bind(_assertThisInitialized(_this));_this.initializeApp=_this.initializeApp.bind(_assertThisInitialized(_this));_this.updateStickers=_this.updateStickers.bind(_assertThisInitialized(_this));_this.updateUser=_this.updateUser.bind(_assertThisInitialized(_this));_this.back=_this.back.bind(_assertThisInitialized(_this));_this.go=_this.go.bind(_assertThisInitialized(_this));return _this;}_createClass(App,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;window.addEventListener('popstate',function(e){e.preventDefault();_this2.back(e);});bridge.subscribe(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref){var _ref$detail,type,data,schemeAttribute,login,user,stickers;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_ref$detail=_ref.detail,type=_ref$detail.type,data=_ref$detail.data;console.log(type,data);if(!(type==='VKWebAppUpdateConfig')){_context.next=8;break;}schemeAttribute=document.createAttribute('scheme');schemeAttribute.value=data.scheme?data.scheme:'client_light';document.body.attributes.setNamedItem(schemeAttribute);_context.next=23;break;case 8:if(!(type==='VKWebAppGetUserInfoResult')){_context.next=23;break;}if(_this2.state.initialized){_context.next=23;break;}_context.next=12;return _this2.get('users.auth');case 12:login=_context.sent;if(!login.access){_context.next=23;break;}_context.next=16;return _this2.get('users.get');case 16:user=_context.sent;data=_objectSpread({},data,{},user.user);_context.next=20;return _this2.get('stickers.get');case 20:stickers=_context.sent;_this2.setState({initialized:true,popout:null,user:data,stickers:stickers.stickers});_this2.initializeApp();case 23:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}());bridge.send('VKWebAppGetUserInfo');}},{key:\"initializeApp\",value:function initializeApp(){this.updateStickers();this.updateUser();}},{key:\"updateStickers\",value:function updateStickers(){var _this3=this;var stickers_panel_new=[];var stickers=this.state.stickers;for(var i=0;i<stickers.length;i++){var stickers_=[];for(var j=0;j<stickers[i].stickers.length;j++){stickers_.push(React.createElement(StickerImg,{mode:\"small\",src:stickers[i].stickers[j]}));}stickers[i].stickers=stickers_;stickers[i].id=i;stickers_panel_new.push(React.createElement(StickerButton,{title:stickers[i].title,author:stickers[i].author,src:stickers[i].preview,price:stickers[i].price,id:\"sticker_\"+i,mode:\"cell\",onClick:function onClick(e){var id=parseInt(e.currentTarget.id.split('_')[1]);_this3.setState({sticker_info:stickers[id]});_this3.go(\"sticker_info\");}}));}stickers_panel_new=stickers_panel_new.reverse();var stickers_panel_popular=stickers_panel_new.sort(function(itemA,itemB){return itemA.sales-itemB.sales;}).reverse();this.setState({stickers_panel_new:stickers_panel_new,stickers_panel_popular:stickers_panel_popular});}},{key:\"updateUser\",value:function updateUser(){var _this4=this;var user_stickers=[];for(var i=0;i<this.state.user.stickers.length;i++){var sticker=this.state.stickers[i];user_stickers.push(React.createElement(StickerButton,{src:sticker.preview,id:\"user_sticker_\"+i,mode:\"img\",onClick:function onClick(e){var id=parseInt(e.currentTarget.id.split('_')[2]);_this4.setState({activeStory:\"tab_main\",sticker_info:_this4.state.stickers[id]});setTimeout(function(){_this4.go(\"sticker_info\");},50);}}));}this.setState({user_stickers:user_stickers});var user_stickers_history=[];for(var i=0;i<this.state.user.stickers_history.length;i++){var sticker=this.state.user.stickers_history[i];user_stickers_history.push(React.createElement(StickerButton,{title:sticker.title,src:sticker.preview,mode2:sticker.hasOwnProperty('added')?sticker.added?'commerce':'destructive':'primary',button:sticker.hasOwnProperty('added')?sticker.added?'Одобрено':'Отклонено':'На проверке',mode:\"cell\"}));}this.setState({user_stickers_history:user_stickers_history});}},{key:\"sleep\",value:function sleep(ms){return new Promise(function(resolve){return setTimeout(resolve,ms);});}},{key:\"go\",value:function go(panel){var _this$setState2;var activeStory=this.state.activeStory;var panel_to_change=activeStory==='tab_main'?'activePanelShop':activeStory==='tab_other'?'activePanelOther':'';var history=activeStory==='tab_main'?this.state.historyShop:activeStory==='tab_other'?this.state.historyOther:'';history.push(panel);var history_to_change=activeStory==='tab_main'?'historyShop':activeStory==='tab_other'?'historyOther':'';window.history.pushState({panel:panel},'Title');this.setState((_this$setState2={},_defineProperty(_this$setState2,panel_to_change,panel),_defineProperty(_this$setState2,history_to_change,history),_this$setState2));}},{key:\"onStoryChange\",value:function onStoryChange(e){var story=e.currentTarget.dataset.story;if(this.state.activeStory===story){if(story==='tab_main'&&this.state.activePanelShop!=='main'){this.back();}else if(story==='tab_other'&&this.state.activePanelOther!=='profile'){this.back();}}this.setState({activeStory:story});}},{key:\"onChange\",value:function onChange(e){var _e$currentTarget=e.currentTarget,name=_e$currentTarget.name,value=_e$currentTarget.value;var create_panel=this.state.create_panel;create_panel[name]=value;this.setState({create_panel:create_panel});}},{key:\"uploadFile\",value:function uploadFile(element,evt){var tgt=evt.target||window.event.srcElement,files=tgt.files;var t=this;if(FileReader&&files&&files.length){var fr=new FileReader();fr.onload=function(){var res=fr.result;//base64 result, to get src -> array[0].props.src\nvar res1=t.state.create_panel;if(files[files.length-1].type.includes('image')){if(element==='upload_sticker_img'){var res10=res1.hasOwnProperty('uploaded_stickers_img')?res1.uploaded_stickers_img:[];res10.push(React.createElement(StickerImg,{mode:'small',id:'uploaded_sticker_'+res10.length,src:res,onClick:function onClick(e){var id=parseInt(e.currentTarget.id.split('_')[2]);var res01=t.state.create_panel;delete res01.uploaded_stickers_img[id];t.setState({create_panel:res01});}}));var stickers_count=res10.filter(function(val){return val!==undefined;}).length;if(stickers_count<100){res1.uploaded_stickers_img=res10;t.setState({create_panel:res1});}}else{res1[element]=res;t.setState({create_panel:res1});}}else{res1[element]=null;t.setState({create_panel:res1});}};fr.readAsDataURL(files[0]);}// Not supported\nelse{// fallback -- perhaps submit the input to an iframe and temporarily store\n// them on the server until the user's session ends.\n}}},{key:\"toggleCreateStickerContext\",value:function toggleCreateStickerContext(){this.setState({createStickerContextOpened:!this.state.createStickerContextOpened});}},{key:\"urlToBase64\",value:function urlToBase64(url){var img=new Image();img.crossOrigin='Anonymous';var ret=img.onload=function(){var canvas=document.createElement('CANVAS'),ctx=canvas.getContext('2d'),dataURL;canvas.height=img.height;canvas.width=img.width;ctx.drawImage(img,0,0);dataURL=canvas.toDataURL(\"image/png\");canvas=null;return dataURL;};img.src=url;return ret;}},{key:\"base64ToMultipart\",value:function(){var _base64ToMultipart=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(base64){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:return _context2.abrupt(\"return\",new Promise(function(resolve){fetch(base64).then(function(res){return res.blob();}).then(function(blob){var fd=new FormData();var file=new File([blob],\"sticker.png\");fd.append('file',file);resolve(fd);});}));case 1:case\"end\":return _context2.stop();}}},_callee2);}));function base64ToMultipart(_x2){return _base64ToMultipart.apply(this,arguments);}return base64ToMultipart;}()},{key:\"sync\",value:function(){var _sync=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(stickers_id){var _this5=this;var stickers,i,sticker_url,base64Img,multipart;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:this.setState({popout:React.createElement(ScreenSpinner,null)});_context4.prev=1;_context4.next=4;return bridge.sendPromise(\"VKWebAppGetAuthToken\",{\"app_id\":7363654,\"scope\":\"docs\"});case 4:access_token=_context4.sent;access_token=access_token.access_token;_context4.next=8;return bridge.sendPromise(\"VKWebAppCallAPIMethod\",{\"method\":\"docs.getUploadServer\",\"request_id\":\"upload_server\",\"params\":{\"group_id\":\"193538803\",\"v\":\"5.103\",\"access_token\":access_token}});case 8:upload_url=_context4.sent;upload_url=upload_url.response.upload_url;stickers=this.state.stickers[stickers_id].stickers;_context4.t0=_regeneratorRuntime.keys(stickers);case 12:if((_context4.t1=_context4.t0()).done){_context4.next=21;break;}i=_context4.t1.value;sticker_url=stickers[i].props.src;base64Img=this.urlToBase64(sticker_url);multipart=this.base64ToMultipart(base64Img);_context4.next=19;return fetch('https://cors-anywhere.herokuapp.com/'+upload_url,{method:'POST',body:multipart}).then(function(res){return res.json();}).then(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(res){var file,save,add;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;file=res.file;_context3.next=4;return bridge.sendPromise(\"VKWebAppCallAPIMethod\",{\"method\":\"docs.save\",\"request_id\":\"save_doc\",\"params\":{\"file\":file,\"v\":\"5.103\",\"access_token\":access_token}});case 4:save=_context3.sent;_context3.next=7;return _this5.sleep(1000);case 7:_context3.next=9;return bridge.sendPromise(\"VKWebAppCallAPIMethod\",{\"method\":\"docs.add\",\"request_id\":\"add_doc\",\"params\":{\"owner_id\":save.response.doc.owner_id,\"doc_id\":save.response.doc.id,\"access_key\":save.response.doc.access_key,\"v\":\"5.103\",\"access_token\":access_token}});case 9:add=_context3.sent;_context3.next=18;break;case 12:_context3.prev=12;_context3.t0=_context3[\"catch\"](0);console.log('error uploading...');i--;_context3.next=18;return _this5.sleep(3000);case 18:case\"end\":return _context3.stop();}}},_callee3,null,[[0,12]]);}));return function(_x4){return _ref3.apply(this,arguments);};}());case 19:_context4.next=12;break;case 21:_context4.next=26;break;case 23:_context4.prev=23;_context4.t2=_context4[\"catch\"](1);console.log('error',_context4.t2);case 26:this.setState({popout:null});case 27:case\"end\":return _context4.stop();}}},_callee4,this,[[1,23]]);}));function sync(_x3){return _sync.apply(this,arguments);}return sync;}()},{key:\"get\",value:function(){var _get=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(method,params){var str,p,response;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(params===undefined||params===null)params={};params.url=window.location.search.replace('?','');str=[];for(p in params){if(params.hasOwnProperty(p)){str.push(encodeURIComponent(p)+\"=\"+encodeURIComponent(params[p]));}}params=str.join(\"&\");_context5.next=7;return fetch('https://ih1705413.vds.myihor.ru:4040/'+method+'?'+params,{method:'GET'}).then(function(res){return res.json();}).then(function(res){return res;});case 7:response=_context5.sent;console.log(response);return _context5.abrupt(\"return\",response);case 10:case\"end\":return _context5.stop();}}},_callee5);}));function get(_x5,_x6){return _get.apply(this,arguments);}return get;}()},{key:\"render\",value:function render(){var _this6=this;return React.createElement(Epic,{activeStory:this.state.activeStory,tabbar:React.createElement(Tabbar,null,React.createElement(TabbarItem,{onClick:this.onStoryChange,selected:this.state.activeStory==='tab_main',\"data-story\":\"tab_main\"},React.createElement(Icon28MarketOutline,null)),React.createElement(TabbarItem,{onClick:this.onStoryChange,selected:this.state.activeStory==='tab_other',\"data-story\":\"tab_other\"},React.createElement(Icon28UserOutline,null)))},React.createElement(View,{id:\"tab_main\",activePanel:this.state.activePanelShop,popout:this.state.popout,history:this.state.historyShop,onSwipeBack:this.back,header:false},React.createElement(Panel,{id:\"main\",separator:false},React.createElement(PanelHeaderSimple,{separator:false},\"\\u0421\\u0442\\u0438\\u043A\\u0435\\u0440\\u044B\"),React.createElement(Tabs,null,React.createElement(TabsItem,{onClick:function onClick(){return _this6.setState({slideTabIndex:0});},selected:this.state.slideTabIndex===0},\"\\u041D\\u043E\\u0432\\u0438\\u043D\\u043A\\u0438\"),React.createElement(TabsItem,{onClick:function onClick(){return _this6.setState({slideTabIndex:1});},selected:this.state.slideTabIndex===1},\"\\u041F\\u043E\\u043F\\u0443\\u043B\\u044F\\u0440\\u043D\\u044B\\u0435\")),React.createElement(Separator,null),React.createElement(PullToRefresh,{onRefresh:/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var response;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_this6.setState({refreshedStickers:true});_context6.next=3;return _this6.get('stickers.get');case 3:response=_context6.sent;_this6.setState({stickers:response.stickers});_context6.next=7;return _this6.updateStickers();case 7:_this6.setState({refreshedStickers:false});case 8:case\"end\":return _context6.stop();}}},_callee6);})),isFetching:this.state.refreshedStickers},React.createElement(Gallery,{slideWidth:\"100%\",style:{height:\"100%\",margin:\"8px\"},slideIndex:this.state.slideTabIndex,onChange:function onChange(slideIndex){_this6.setState({slideTabIndex:slideIndex});}},React.createElement(\"div\",null,React.createElement(List,{style:{marginTop:\"15px\"}},this.state.stickers_panel_new)),React.createElement(\"div\",null,React.createElement(List,{style:{marginTop:\"15px\"}},this.state.stickers_panel_popular))))),React.createElement(Panel,{id:\"sticker_info\"},React.createElement(PanelHeaderSimple,null,React.createElement(PanelHeaderContent,null,\"\\u0418\\u043D\\u0444\\u043E\\u0440\\u043C\\u0430\\u0446\\u0438\\u044F\")),React.createElement(Div,null,React.createElement(Cell,{before:React.createElement(StickerImg,{mode:'medium',src:this.state.sticker_info.preview}),description:this.state.sticker_info.author},this.state.sticker_info.title),React.createElement(\"br\",null),React.createElement(StickerDescription,null,this.state.sticker_info.description),React.createElement(\"div\",{style:{marginTop:'10px'}},this.state.user.stickers.indexOf(this.state.sticker_info.id)>=0?React.createElement(\"div\",{style:{display:'flex'}},React.createElement(Button,{onClick:function onClick(){/*this.install(this.state.sticker_info.id);*/},size:\"xl\",stretched:true},'Установить'),\" \",React.createElement(Button,{style:{marginLeft:'8px'},mode:\"secondary\",size:\"xl\",stretched:true},'Очистить')):React.createElement(\"div\",{style:{display:'flex'}},React.createElement(Button,{size:\"xl\",stretched:true,mode:\"commerce\"},'Получить за '+this.state.sticker_info.price+' руб.')),this.state.user.is_admin&&React.createElement(\"div\",{style:{display:'flex',marginTop:'10px'}},React.createElement(Button,{onClick:function onClick(){_this6.sync(_this6.state.sticker_info.id);},size:\"xl\",stretched:true},'Синхронизировать'))),React.createElement(\"div\",{className:\"centered\",style:{marginTop:\"18px\"}},React.createElement(StickerGrid,{mode:\"small\"},this.state.sticker_info.stickers))))),React.createElement(View,{id:\"tab_other\",activePanel:this.state.activePanelOther,popout:this.state.popout,history:this.state.historyOther,onSwipeBack:this.back,header:false},React.createElement(Panel,{id:\"profile\"},React.createElement(PanelHeaderSimple,null,React.createElement(PanelHeaderContent,null,\"\\u041F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C\")),React.createElement(PullToRefresh,{onRefresh:/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(){var response,user_;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_this6.setState({refreshedProfile:true});_context7.next=3;return _this6.get('users.get');case 3:response=_context7.sent;_context7.next=6;return bridge.sendPromise('VKWebAppGetUserInfo');case 6:user_=_context7.sent;_this6.setState({user:_objectSpread({},user_,{},response.user)});_context7.next=10;return _this6.updateUser();case 10:_this6.setState({refreshedProfile:false});case 11:case\"end\":return _context7.stop();}}},_callee7);})),isFetching:this.state.refreshedProfile},React.createElement(Div,null,React.createElement(\"div\",{className:\"centered\"},React.createElement(Avatar,{src:this.state.user.photo_100,size:100})),React.createElement(\"br\",null),React.createElement(\"div\",{className:\"centered\",style:{fontSize:\"large\"}},this.state.user.first_name+' '+this.state.user.last_name),React.createElement(\"br\",null),React.createElement(Group,{separator:\"hide\"},React.createElement(Cell,{asideContent:React.createElement(Icon16Dropdown,{style:{transform:\"rotate(\".concat(this.state.balance_manipulation?'180deg':'0',\")\")}}),onClick:function onClick(){_this6.setState({balance_manipulation:!_this6.state.balance_manipulation});},indicator:this.state.user.balance+' ₽'},\"\\u0412\\u0430\\u0448 \\u0431\\u0430\\u043B\\u0430\\u043D\\u0441\"),this.state.balance_manipulation&&React.createElement(\"div\",{style:{display:'flex',justifyContent:'flex-end',marginTop:'8px'}},React.createElement(Button,{size:\"l\",before:React.createElement(Icon16Down,null)},\"\\u041F\\u043E\\u043F\\u043E\\u043B\\u043D\\u0438\\u0442\\u044C\"),React.createElement(Button,{size:\"l\",before:React.createElement(Icon16Up,null),mode:\"secondary\",style:{marginLeft:8}},\"\\u0412\\u044B\\u0432\\u0435\\u0441\\u0442\\u0438\"))),React.createElement(Group,{separator:\"hide\",header:React.createElement(Header,{mode:\"primary\"},\"\\u0412\\u0430\\u0448\\u0438 \\u0441\\u0442\\u0438\\u043A\\u0435\\u0440\\u044B\")},React.createElement(\"div\",{className:\"centered\",style:{marginTop:\"18px\"}},React.createElement(StickerGrid,{mode:\"big\"},this.state.user_stickers,React.createElement(StickerImg,{mode:'big',onClick:function onClick(){_this6.go(\"create\");}},\"+\"))))))),React.createElement(Panel,{id:\"create\"},React.createElement(PanelHeaderSimple,null,React.createElement(PanelHeaderContent,{aside:React.createElement(Icon16Dropdown,{style:{transform:\"rotate(\".concat(this.state.createStickerContextOpened?'180deg':'0',\")\")}}),onClick:function onClick(){_this6.toggleCreateStickerContext();}},\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u0441\\u0442\\u0438\\u043A\\u0435\\u0440\\u044B\")),React.createElement(PanelHeaderContext,{opened:this.state.createStickerContextOpened,onClose:function onClose(){_this6.toggleCreateStickerContext();}},React.createElement(List,null,React.createElement(Cell,{before:React.createElement(Icon28HistoryForwardOutline,null),onClick:function onClick(){_this6.toggleCreateStickerContext();_this6.go(\"stickers_history\");}},\"\\u0418\\u0441\\u0442\\u043E\\u0440\\u0438\\u044F\"))),React.createElement(FormLayout,null,React.createElement(Input,{type:\"text\",top:\"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435 \\u0441\\u0442\\u0438\\u043A\\u0435\\u0440-\\u043F\\u0430\\u043A\\u0430\",name:\"title\",value:this.state.create_panel.title,onChange:this.onChange,status:this.state.create_panel.title?this.state.create_panel.title.length<=20?'valid':'error':'error',bottom:this.state.create_panel.title?this.state.create_panel.title.length<=20?'':'Максимальная длина - 20':'Пожалуйста, введите название'}),React.createElement(Input,{type:\"text\",top:\"\\u041E\\u043F\\u0438\\u0441\\u0430\\u043D\\u0438\\u0435\",name:\"description\",value:this.state.create_panel.description,onChange:this.onChange,status:this.state.create_panel.description?this.state.create_panel.description.length<=100?'valid':'error':'error',bottom:this.state.create_panel.description?this.state.create_panel.description.length<=100?'':'Максимальная длина - 100':'Пожалуйста, введите описание'}),React.createElement(Input,{type:\"number\",top:\"\\u0426\\u0435\\u043D\\u0430\",name:\"price\",value:this.state.create_panel.price,onChange:this.onChange,status:this.state.create_panel.price>0?this.state.create_panel.price<=1000?this.state.create_panel.price.toString().includes('.')?'error':'valid':'error':'error',bottom:this.state.create_panel.price>0?this.state.create_panel.price<=1000?this.state.create_panel.price.toString().includes('.')?'Число должно быть целым':'':'Максимальная цена- 1 000 руб.':'Минимальная цена - 1 руб.'}),React.createElement(StickerUploadButton,{src:this.state.create_panel.upload_preview_img&&this.state.create_panel.upload_preview_img,title:'Превью',description:'Загрузите главную фотографию стикер-пака (128×128px)',onChange:function onChange(event){_this6.uploadFile('upload_preview_img',event);}}),React.createElement(StickerUploadButton,{title:'Стикеры',description:'Загрузите все стикеры (минимум - 4), которые будут содержаться в паке (128×128px)',onChange:function onChange(event){_this6.uploadFile('upload_sticker_img',event);}}),React.createElement(\"div\",{className:\"centered\",style:{paddingBottom:\"16px\"}},React.createElement(\"div\",{style:{minWidth:\"64px\",maxWidth:\"296px\",display:\"grid\",gridTemplateColumns:\"repeat(auto-fill, 64px)\",gridGap:\"10px\"}},this.state.create_panel.uploaded_stickers_img)),React.createElement(Button,{size:\"xl\",disabled:this.state.create_panel.title?this.state.create_panel.description?this.state.create_panel.price>0?this.state.create_panel.title.length<=20?this.state.create_panel.description.length<=100?this.state.create_panel.price<=1000?this.state.create_panel.price.toString().includes('.')?true:this.state.create_panel.upload_preview_img?this.state.create_panel.uploaded_stickers_img?this.state.create_panel.uploaded_stickers_img.filter(function(val){return val!==undefined;}).length>=4?false:true:true:true:true:true:true:true:true:true},\"\\u041F\\u0440\\u043E\\u0434\\u043E\\u043B\\u0436\\u0438\\u0442\\u044C\"))),React.createElement(Panel,{id:\"stickers_history\"},React.createElement(PanelHeaderSimple,null,React.createElement(PanelHeaderContent,null,\"\\u0418\\u0441\\u0442\\u043E\\u0440\\u0438\\u044F\")),this.state.user_stickers_history&&this.state.user_stickers_history.length>0?React.createElement(Div,null,React.createElement(List,null,this.state.user_stickers_history)):React.createElement(Placeholder,{icon:React.createElement(Icon56HistoryOutline,null),header:'Пусто',stretched:true},\"\\u0412\\u044B \\u043F\\u043E\\u043A\\u0430 \\u0435\\u0449\\u0435 \\u043D\\u0435 \\u0441\\u043E\\u0437\\u0434\\u0430\\u0432\\u0430\\u043B\\u0438 \\u0441\\u0442\\u0438\\u043A\\u0435\\u0440\\u044B\"))));}}]);return App;}(React.Component);export default App;","map":{"version":3,"sources":["C:/Users/Admin/NodeProjects/VKStickers2/src/App.js"],"names":["React","bridge","Panel","PanelHeader","Div","View","ScreenSpinner","List","Cell","Gallery","FormLayout","Input","Avatar","Group","Epic","Tabbar","TabbarItem","Separator","Button","PanelHeaderContext","Header","PanelHeaderSimple","PanelHeaderContent","Placeholder","Tabs","TabsItem","PullToRefresh","Icon16Dropdown","Icon16Down","Icon16Up","Icon28HistoryForwardOutline","Icon28MarketOutline","Icon28UserOutline","Icon56HistoryOutline","StickerImg","StickerButton","StickerDescription","StickerGrid","StickerUploadButton","access_token","upload_url","App","props","back","activeStory","state","activePanel","activePanelShop","activePanelOther","panel_to_change","send","history","historyShop","historyOther","length","pop","p","setState","initialized","popout","slideTabIndex","createStickerContextOpened","balance_manipulation","stickers","title","author","preview","price","description","stickers_panel","sticker_info","user","first_name","last_name","photo_100","balance","stickers_history","create_panel","onStoryChange","bind","onChange","uploadFile","toggleCreateStickerContext","sync","componentDidMount","initializeApp","updateStickers","updateUser","go","window","addEventListener","e","preventDefault","subscribe","detail","type","data","console","log","schemeAttribute","document","createAttribute","value","scheme","body","attributes","setNamedItem","get","login","access","stickers_panel_new","i","stickers_","j","push","id","parseInt","currentTarget","split","reverse","stickers_panel_popular","sort","itemA","itemB","sales","user_stickers","sticker","setTimeout","user_stickers_history","hasOwnProperty","added","ms","Promise","resolve","panel","history_to_change","pushState","story","dataset","name","element","evt","tgt","target","event","srcElement","files","t","FileReader","fr","onload","res","result","res1","includes","res10","uploaded_stickers_img","res01","stickers_count","filter","val","undefined","readAsDataURL","url","img","Image","crossOrigin","ret","canvas","createElement","ctx","getContext","dataURL","height","width","drawImage","toDataURL","src","base64","fetch","then","blob","fd","FormData","file","File","append","stickers_id","sendPromise","response","sticker_url","base64Img","urlToBase64","multipart","base64ToMultipart","method","json","save","sleep","doc","owner_id","access_key","add","params","location","search","replace","str","encodeURIComponent","join","refreshedStickers","margin","slideIndex","marginTop","indexOf","display","marginLeft","is_admin","refreshedProfile","user_","fontSize","transform","justifyContent","toString","upload_preview_img","paddingBottom","minWidth","maxWidth","gridTemplateColumns","gridGap","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport bridge from '@vkontakte/vk-bridge';\nimport '@vkontakte/vkui/dist/vkui.css';\nimport './css/App.css'\n\nimport { Panel, PanelHeader, Div , View , ScreenSpinner, List , Cell , Gallery , FormLayout , Input , Avatar , Group , Epic, Tabbar, TabbarItem, Separator, Button, PanelHeaderContext, Header, PanelHeaderSimple, PanelHeaderContent, Placeholder, Tabs,\n\tTabsItem, PullToRefresh  } from '@vkontakte/vkui';\n\nimport Icon16Dropdown from '@vkontakte/icons/dist/16/dropdown';\nimport Icon16Down from '@vkontakte/icons/dist/16/down';\nimport Icon16Up from '@vkontakte/icons/dist/16/up';\nimport Icon28HistoryForwardOutline from '@vkontakte/icons/dist/28/history_forward_outline';\nimport Icon28MarketOutline from '@vkontakte/icons/dist/28/market_outline';\nimport Icon28UserOutline from '@vkontakte/icons/dist/28/user_outline';\nimport Icon56HistoryOutline from '@vkontakte/icons/dist/56/history_outline';\n\nimport {StickerImg} from \"./components/StickerImg\";\nimport {StickerButton} from \"./components/StickerButton\";\nimport {StickerDescription} from \"./components/StickerDescription\";\nimport {StickerGrid} from \"./components/StickerGrid\";\nimport {StickerUploadButton} from \"./components/StickerUploadButton\";\n\nvar access_token = '', upload_url = '';\n\nclass App extends React.Component {\n\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = {\n\t\t\tinitialized: false,\n\t\t\tpopout: <ScreenSpinner/>,\n\t\t\tactiveStory: 'tab_main',\n\t\t\tslideTabIndex: 0,\n\t\t\tactivePanelShop: \"main\",\n\t\t\thistoryShop: [\"main\"],\n\t\t\tactivePanelOther: \"profile\",\n\t\t\thistoryOther: [\"profile\"],\n\t\t\tcreateStickerContextOpened: false,\n\t\t\tbalance_manipulation: false,\n\t\t\tstickers: [ { title: \"Бисквит\", author: \"Ирина Брэдкэт\", preview: \"https://vk.com/sticker/2-533-cover-140b-0\", price: 1, description: \"Хвост торчком, большие ушки —\\nБерегитесь, печенюшки!\", stickers: [ 'https://vk.com/sticker/1-18945-64', 'https://vk.com/sticker/1-18946-64', 'https://vk.com/sticker/1-18947-64', 'https://vk.com/sticker/1-18948-64', 'https://vk.com/sticker/1-18949-64', 'https://vk.com/sticker/1-18950-64', 'https://vk.com/sticker/1-18951-64', 'https://vk.com/sticker/1-18952-64' ] }, { title: \"Илай\", author: \"Ирина Брэдкэт\", preview: \"https://vk.com/sticker/1-18781-128\", price: 1, description: \"Вышел мишка из берлоги — поселился в диалоге.\", stickers: [ 'https://vk.com/sticker/1-18781-128', 'https://vk.com/sticker/1-18782-128', 'https://vk.com/sticker/1-18783-128', 'https://vk.com/sticker/1-18784-128', 'https://vk.com/sticker/1-18785-128', 'https://vk.com/sticker/1-18786-128', 'https://vk.com/sticker/1-18787-128', 'https://vk.com/sticker/1-18788-128' ] } ],\n\t\t\tstickers_panel: null,\n\t\t\tsticker_info: { title: \"\", author: \"\", preview: \"\", price: 0, description: \"\", stickers: [] },\n\t\t\tuser: {\n\t\t\t\tfirst_name: '',\n\t\t\t\tlast_name: '',\n\t\t\t\tphoto_100: '',\n\t\t\t\tstickers:[ ],\n\t\t\t\tbalance: 0,\n\t\t\t\tstickers_history: [ ]\n\t\t\t},\n\t\t\tcreate_panel: { title: \"\", preview: \"\", price: 1, description: \"\", stickers: [] }\n\t\t};\n\n\t\tthis.onStoryChange = this.onStoryChange.bind(this);\n\t\tthis.onChange = this.onChange.bind(this);\n\t\tthis.uploadFile = this.uploadFile.bind(this);\n\t\tthis.toggleCreateStickerContext = this.toggleCreateStickerContext.bind(this);\n\t\tthis.sync = this.sync.bind(this);\n\n\t\tthis.componentDidMount = this.componentDidMount.bind(this);\n\t\tthis.initializeApp = this.initializeApp.bind(this);\n\t\tthis.updateStickers = this.updateStickers.bind(this);\n\t\tthis.updateUser = this.updateUser.bind(this);\n\t\tthis.back = this.back.bind(this);\n\t\tthis.go = this.go.bind(this);\n\t}\n\n\tcomponentDidMount () {\n\t\twindow.addEventListener('popstate', e => {\n\t\t\te.preventDefault();\n\t\t\tthis.back(e);\n\t\t});\n\t\tbridge.subscribe(async ({ detail: { type, data }}) => {\n\t\t\tconsole.log(type, data);\n\t\t\tif (type === 'VKWebAppUpdateConfig') {\n\t\t\t\tconst schemeAttribute = document.createAttribute('scheme');\n\t\t\t\tschemeAttribute.value = data.scheme ? data.scheme : 'client_light';\n\t\t\t\tdocument.body.attributes.setNamedItem(schemeAttribute);\n\t\t\t} else if (type === 'VKWebAppGetUserInfoResult'){\n\t\t\t\tif(!this.state.initialized){\n\t\t\t\t\tlet login = await this.get('users.auth');\n\t\t\t\t\tif(login.access){\n\t\t\t\t\t\t/*\n                        data.stickers = [ 0 ];\n                        data.balance = 0;\n                        data.stickers_history = [ { title: \"Илай\", preview: \"https://vk.com/sticker/1-18781-128\", added: false }, { title: \"Бисквит\", author: \"Илья Ульянов\", preview: \"https://vk.com/sticker/2-533-cover-140b-0\" } ];\n                        */\n\t\t\t\t\t\tlet user = await this.get('users.get');\n\t\t\t\t\t\tdata = { ...data, ...user.user };\n\t\t\t\t\t\tlet stickers = await this.get('stickers.get');\n\t\t\t\t\t\tthis.setState({ initialized: true, popout: null, user: data, stickers: stickers.stickers });\n\t\t\t\t\t\tthis.initializeApp();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tbridge.send('VKWebAppGetUserInfo');\n\t}\n\n\tinitializeApp() {\n\t\tthis.updateStickers();\n\t\tthis.updateUser();\n\t}\n\tupdateStickers(){\n\t\tvar stickers_panel_new = [];\n\t\tvar stickers = this.state.stickers;\n\t\tfor(var i = 0; i < stickers.length; i++){\n\t\t\tvar stickers_ = [];\n\t\t\tfor(var j = 0; j < stickers[i].stickers.length; j++){\n\t\t\t\tstickers_.push(\n\t\t\t\t\t<StickerImg mode={\"small\"} src={stickers[i].stickers[j]}/>\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tstickers[i].stickers = stickers_;\n\t\t\tstickers[i].id = i;\n\t\t\tstickers_panel_new.push(\n\t\t\t\t<StickerButton\n\t\t\t\t\ttitle={stickers[i].title}\n\t\t\t\t\tauthor={stickers[i].author}\n\t\t\t\t\tsrc={stickers[i].preview}\n\t\t\t\t\tprice={stickers[i].price}\n\t\t\t\t\tid={\"sticker_\" + i}\n\t\t\t\t\tmode={\"cell\"}\n\t\t\t\t\tonClick={(e)=> {\n\t\t\t\t\t\tvar id = parseInt(e.currentTarget.id.split('_')[1]);\n\t\t\t\t\t\tthis.setState({sticker_info: stickers[id]});\n\t\t\t\t\t\tthis.go(\"sticker_info\");\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\t\tstickers_panel_new = stickers_panel_new.reverse();\n\t\tvar stickers_panel_popular = stickers_panel_new.sort(function (itemA, itemB) {\n\t\t\treturn itemA.sales - itemB.sales;\n\t\t}).reverse();\n\t\tthis.setState({ stickers_panel_new, stickers_panel_popular });\n\t}\n\tupdateUser(){\n\t\tvar user_stickers = [];\n\t\tfor(var i = 0; i < this.state.user.stickers.length; i++){\n\t\t\tvar sticker = this.state.stickers[i];\n\t\t\tuser_stickers.push(\n\t\t\t\t<StickerButton\n\t\t\t\t\tsrc={sticker.preview}\n\t\t\t\t\tid={\"user_sticker_\" + i}\n\t\t\t\t\tmode={\"img\"}\n\t\t\t\t\tonClick={(e) => {\n\t\t\t\t\t\tvar id = parseInt(e.currentTarget.id.split('_')[2]);\n\t\t\t\t\t\tthis.setState({activeStory: \"tab_main\", sticker_info: this.state.stickers[id]});\n\t\t\t\t\t\tsetTimeout(() => { this.go(\"sticker_info\"); }, 50)\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\t\tthis.setState({ user_stickers });\n\n\t\tvar user_stickers_history = [];\n\t\tfor (var i = 0; i < this.state.user.stickers_history.length; i++) {\n\t\t\tvar sticker = this.state.user.stickers_history[i];\n\t\t\tuser_stickers_history.push(\n\t\t\t\t<StickerButton\n\t\t\t\t\ttitle={sticker.title}\n\t\t\t\t\tsrc={sticker.preview}\n\t\t\t\t\tmode2={sticker.hasOwnProperty('added') ? (sticker.added ? 'commerce' : 'destructive') : 'primary'}\n\t\t\t\t\tbutton={sticker.hasOwnProperty('added') ? (sticker.added ? 'Одобрено' : 'Отклонено') : 'На проверке'}\n\t\t\t\t\tmode={\"cell\"}\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\t\tthis.setState({ user_stickers_history });\n\t}\n\tsleep(ms) {\n\t\treturn new Promise(resolve => setTimeout(resolve, ms));\n\t}\n\tback = () => {\n\t\tlet activeStory = this.state.activeStory;\n\t\tlet activePanel = activeStory === 'tab_main' ? this.state.activePanelShop : activeStory === 'tab_other' ? this.state.activePanelOther : '';\n\t\tlet panel_to_change = activeStory === 'tab_main' ? 'activePanelShop' : activeStory === 'tab_other' ? 'activePanelOther' : '';\n\t\tif((activeStory === 'tab_main' && activePanel==='main') || (activeStory === 'tab_other' && activePanel==='profile')){\n\t\t\tbridge.send(\"VKWebAppClose\", {\"status\": \"success\"});\n\t\t}else {\n\t\t\tlet history = activeStory === 'tab_main' ? this.state.historyShop : activeStory === 'tab_other' ? this.state.historyOther : '';\n\t\t\tif(history.length === 1) {\n\t\t\t\tbridge.send(\"VKWebAppClose\", {\"status\": \"success\"});\n\t\t\t} else if (history.length > 1) {\n\t\t\t\thistory.pop();\n\t\t\t\tlet p = history[history.length - 1];\n\t\t\t\tthis.setState({[panel_to_change]: p});\n\t\t\t}\n\t\t}\n\t};\n\tgo(panel) {\n\t\tlet activeStory = this.state.activeStory;\n\t\tlet panel_to_change = activeStory === 'tab_main' ? 'activePanelShop' : activeStory === 'tab_other' ? 'activePanelOther' : '';\n\t\tlet history = activeStory === 'tab_main' ? this.state.historyShop : activeStory === 'tab_other' ? this.state.historyOther : '';\n\t\thistory.push(panel);\n\t\tlet history_to_change = activeStory === 'tab_main' ? 'historyShop' : activeStory === 'tab_other' ? 'historyOther' : '';\n\t\twindow.history.pushState({panel: panel}, 'Title');\n\t\tthis.setState({ [panel_to_change]: panel, [history_to_change]: history });\n\t}\n\n\tonStoryChange (e) {\n\t\tvar story = e.currentTarget.dataset.story;\n\t\tif(this.state.activeStory===story){\n\t\t\tif(story==='tab_main' && this.state.activePanelShop !== 'main'){\n\t\t\t\tthis.back();\n\t\t\t}else if(story==='tab_other' && this.state.activePanelOther !== 'profile'){\n\t\t\t\tthis.back();\n\t\t\t}\n\t\t}\n\t\tthis.setState({ activeStory: story });\n\t}\n\n\tonChange(e) {\n\t\tconst { name, value } = e.currentTarget;\n\t\tvar create_panel = this.state.create_panel;\n\t\tcreate_panel[name] = value;\n\t\tthis.setState({ create_panel: create_panel });\n\t}\n\n\tuploadFile(element, evt) {\n\t\tvar tgt = evt.target || window.event.srcElement,\n\t\t\tfiles = tgt.files;\n\t\tconst t = this;\n\t\tif (FileReader && files && files.length) {\n\t\t\tvar fr = new FileReader();\n\t\t\tfr.onload = function () {\n\t\t\t\tvar res = fr.result; //base64 result, to get src -> array[0].props.src\n\t\t\t\tvar res1 = t.state.create_panel;\n\t\t\t\tif(files[files.length-1].type.includes('image')){\n\t\t\t\t\tif(element==='upload_sticker_img'){\n\t\t\t\t\t\tvar res10 = res1.hasOwnProperty('uploaded_stickers_img') ? res1.uploaded_stickers_img : [];\n\t\t\t\t\t\tres10.push(\n\t\t\t\t\t\t    <StickerImg\n\t\t\t\t\t\t\t\tmode={'small'}\n                                id={'uploaded_sticker_'+res10.length}\n                                src={res}\n\t\t\t\t\t\t\t\tonClick={(e)=>{ var id = parseInt(e.currentTarget.id.split('_')[2]); var res01 = t.state.create_panel; delete res01.uploaded_stickers_img[id];  t.setState({ create_panel: res01 }); }}\n                            />\n\t\t\t\t\t\t);\n\t\t\t\t\t\tvar stickers_count = res10.filter(function(val){ return val !== undefined; }).length;\n\t\t\t\t\t\tif(stickers_count<100){\n\t\t\t\t\t\t\tres1.uploaded_stickers_img = res10;\n\t\t\t\t\t\t\tt.setState({ create_panel: res1 });\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\tres1[element] = res;\n\t\t\t\t\t\tt.setState({ create_panel: res1});\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tres1[element] = null;\n\t\t\t\t\tt.setState({ create_panel: res1});\n\t\t\t\t}\n\t\t\t}\n\t\t\tfr.readAsDataURL(files[0]);\n\t\t}\n\n\t\t// Not supported\n\t\telse {\n\t\t\t// fallback -- perhaps submit the input to an iframe and temporarily store\n\t\t\t// them on the server until the user's session ends.\n\t\t}\n\t}\n\n\ttoggleCreateStickerContext () {\n\t\tthis.setState({ createStickerContextOpened: !this.state.createStickerContextOpened });\n\t}\n\n\turlToBase64(url){\n\t\tvar img = new Image();\n\t\timg.crossOrigin = 'Anonymous';\n\t\tvar ret = img.onload = function(){\n\t\t\tvar canvas = document.createElement('CANVAS'),\n\t\t\t\tctx = canvas.getContext('2d'), dataURL;\n\t\t\tcanvas.height = img.height;\n\t\t\tcanvas.width = img.width;\n\t\t\tctx.drawImage(img, 0, 0);\n\t\t\tdataURL = canvas.toDataURL(\"image/png\");\n\t\t\tcanvas = null;\n\t\t\treturn dataURL;\n\t\t};\n\t\timg.src = url;\n\t\treturn ret;\n\t}\n\n\tasync base64ToMultipart(base64) {\n\t\treturn new Promise(resolve => {\n\t\t\tfetch(base64)\n\t\t\t\t.then(res => res.blob())\n\t\t\t\t.then(blob => {\n\t\t\t\t\tconst fd = new FormData();\n\t\t\t\t\tconst file = new File([blob], \"sticker.png\");\n\t\t\t\t\tfd.append('file', file);\n\t\t\t\t\tresolve(fd);\n\t\t\t\t});\n\t\t});\n\t}\n\n\tasync sync(stickers_id) {\n\t\tthis.setState({ popout: <ScreenSpinner/> });\n\t\ttry{\n\t\t\taccess_token = await bridge.sendPromise(\"VKWebAppGetAuthToken\", {\"app_id\": 7363654, \"scope\": \"docs\"});\n\t\t\taccess_token = access_token.access_token;\n\t\t\tupload_url = await bridge.sendPromise(\"VKWebAppCallAPIMethod\", {\"method\": \"docs.getUploadServer\", \"request_id\": \"upload_server\", \"params\": {\"group_id\":\"193538803\", \"v\":\"5.103\", \"access_token\":access_token}});\n\t\t\tupload_url = upload_url.response.upload_url;\n\t\t\tvar stickers = this.state.stickers[stickers_id].stickers;\n\t\t\tfor(var i in stickers){\n\t\t\t\tvar sticker_url = stickers[i].props.src;\n\t\t\t\tvar base64Img = this.urlToBase64(sticker_url);\n\t\t\t\tvar multipart = this.base64ToMultipart(base64Img);\n\n\t\t\t\tawait fetch('https://cors-anywhere.herokuapp.com/'+upload_url, {method: 'POST', body: multipart})\n\t\t\t\t\t.then(res => res.json())\n\t\t\t\t\t.then(async res => {\n\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\tvar file = res.file;\n\t\t\t\t\t\t\tvar save = await bridge.sendPromise(\"VKWebAppCallAPIMethod\", {\n\t\t\t\t\t\t\t\t\"method\": \"docs.save\",\n\t\t\t\t\t\t\t\t\"request_id\": \"save_doc\",\n\t\t\t\t\t\t\t\t\"params\": {\"file\":file, \"v\": \"5.103\", \"access_token\": access_token}\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t//await this.get('stickers.sync', { id_: i, id: stickers_id, owner_id: save.response.graffiti.owner_id, doc_id: save.response.graffiti.id, access_key: save.response.graffiti.access_key });\n\n\t\t\t\t\t\t\tawait this.sleep(1000);\n\n\t\t\t\t\t\t\tvar add = await bridge.sendPromise(\"VKWebAppCallAPIMethod\", {\n\t\t\t\t\t\t\t\t\"method\": \"docs.add\",\n\t\t\t\t\t\t\t\t\"request_id\": \"add_doc\",\n\t\t\t\t\t\t\t\t\"params\": {\"owner_id\": save.response.doc.owner_id, \"doc_id\": save.response.doc.id, \"access_key\": save.response.doc.access_key, \"v\": \"5.103\", \"access_token\": access_token}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}catch (e) {\n\t\t\t\t\t\t\tconsole.log('error uploading...');\n\t\t\t\t\t\t\ti--;\n\t\t\t\t\t\t\tawait this.sleep(3000);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t}\n\t\t}catch (e) {\n\t\t\tconsole.log('error',e);\n\t\t}\n\t\tthis.setState({ popout: null });\n\t}\n\n\tasync get(method, params) {\n\t\tif(params === undefined || params === null) params = {};\n\t\tparams.url = window.location.search.replace('?', '');\n\t\tvar str = [];\n\t\tfor (var p in params)\n\t\t\tif (params.hasOwnProperty(p)) {\n\t\t\t\tstr.push(encodeURIComponent(p) + \"=\" + encodeURIComponent(params[p]));\n\t\t\t}\n\t\tparams = str.join(\"&\");\n\t\tlet response = await fetch('https://ih1705413.vds.myihor.ru:4040/'+method+'?'+params, {method: 'GET'})\n\t\t\t.then(res => res.json())\n\t\t\t.then(res => {\n\t\t\t\treturn res;\n\t\t\t});\n\t\tconsole.log(response);\n\t\treturn response;\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<Epic activeStory={this.state.activeStory} tabbar={\n\t\t\t\t<Tabbar>\n\t\t\t\t\t<TabbarItem\n\t\t\t\t\t\tonClick={this.onStoryChange}\n\t\t\t\t\t\tselected={this.state.activeStory === 'tab_main'}\n\t\t\t\t\t\tdata-story=\"tab_main\"\n\t\t\t\t\t><Icon28MarketOutline/></TabbarItem>\n\t\t\t\t\t<TabbarItem\n\t\t\t\t\t\tonClick={this.onStoryChange}\n\t\t\t\t\t\tselected={this.state.activeStory === 'tab_other'}\n\t\t\t\t\t\tdata-story=\"tab_other\"\n\t\t\t\t\t><Icon28UserOutline /></TabbarItem>\n\t\t\t\t</Tabbar>\n\t\t\t}>\n\t\t\t\t<View id=\"tab_main\" activePanel={this.state.activePanelShop} popout={this.state.popout} history={this.state.historyShop} onSwipeBack={this.back} header={false}>\n\t\t\t\t\t<Panel id=\"main\" separator={false}>\n\t\t\t\t\t\t<PanelHeaderSimple\n\t\t\t\t\t\t\tseparator={false}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tСтикеры\n\t\t\t\t\t\t</PanelHeaderSimple>\n\t\t\t\t\t\t<Tabs>\n\t\t\t\t\t\t\t<TabsItem\n\t\t\t\t\t\t\t\tonClick={() => this.setState({ slideTabIndex: 0 })}\n\t\t\t\t\t\t\t\tselected={this.state.slideTabIndex === 0}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tНовинки\n\t\t\t\t\t\t\t</TabsItem>\n\t\t\t\t\t\t\t<TabsItem\n\t\t\t\t\t\t\t\tonClick={() => this.setState({ slideTabIndex: 1 })}\n\t\t\t\t\t\t\t\tselected={this.state.slideTabIndex === 1}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tПопулярные\n\t\t\t\t\t\t\t</TabsItem>\n\t\t\t\t\t\t</Tabs>\n\t\t\t\t\t\t<Separator />\n\t\t\t\t\t\t<PullToRefresh onRefresh={async () => {\n\t\t\t\t\t\t\tthis.setState({ refreshedStickers: true });\n\t\t\t\t\t\t\tlet response = await this.get('stickers.get');\n\t\t\t\t\t\t\tthis.setState({ stickers: response.stickers });\n\t\t\t\t\t\t\tawait this.updateStickers();\n\t\t\t\t\t\t\tthis.setState({ refreshedStickers: false });\n\t\t\t\t\t\t}} isFetching={this.state.refreshedStickers}>\n\t\t\t\t\t\t\t<Gallery\n\t\t\t\t\t\t\t\tslideWidth=\"100%\"\n\t\t\t\t\t\t\t\tstyle={{ height: \"100%\", margin: \"8px\" }}\n\t\t\t\t\t\t\t\tslideIndex={this.state.slideTabIndex}\n\t\t\t\t\t\t\t\tonChange={(slideIndex) => { this.setState({slideTabIndex: slideIndex}); }}>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<List style={{ marginTop: \"15px\" }}>\n\t\t\t\t\t\t\t\t\t\t{this.state.stickers_panel_new}\n\t\t\t\t\t\t\t\t\t</List>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<List style={{ marginTop: \"15px\" }}>\n\t\t\t\t\t\t\t\t\t\t{this.state.stickers_panel_popular}\n\t\t\t\t\t\t\t\t\t</List>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</Gallery>\n\t\t\t\t\t\t</PullToRefresh>\n\t\t\t\t\t</Panel>\n\t\t\t\t\t<Panel id=\"sticker_info\">\n\t\t\t\t\t\t<PanelHeaderSimple><PanelHeaderContent>\n\t\t\t\t\t\t\tИнформация\n\t\t\t\t\t\t</PanelHeaderContent></PanelHeaderSimple>\n\t\t\t\t\t\t<Div>\n\t\t\t\t\t\t\t<Cell before={<StickerImg mode={'medium'} src={this.state.sticker_info.preview}/>} description={this.state.sticker_info.author}>{this.state.sticker_info.title}</Cell>\n\t\t\t\t\t\t\t<br/>\n\t\t\t\t\t\t\t<StickerDescription>{this.state.sticker_info.description}</StickerDescription>\n\t\t\t\t\t\t\t<div style={{ marginTop: '10px'}}>\n\t\t\t\t\t\t\t\t{this.state.user.stickers.indexOf(this.state.sticker_info.id)>=0 ? <div style={{ display: 'flex' }}><Button onClick={()=>{ /*this.install(this.state.sticker_info.id);*/ }} size={\"xl\"} stretched>{'Установить'}</Button> <Button style={{ marginLeft: '8px' }} mode={\"secondary\"} size={\"xl\"} stretched>{'Очистить'}</Button></div> : <div style={{ display: 'flex' }}><Button size={\"xl\"} stretched mode=\"commerce\">{'Получить за '+this.state.sticker_info.price+' руб.'}</Button></div>}\n\t\t\t\t\t\t\t\t{this.state.user.is_admin && <div style={{ display: 'flex', marginTop: '10px' }}><Button onClick={()=> { this.sync(this.state.sticker_info.id); }} size={\"xl\"} stretched>{'Синхронизировать'}</Button></div>}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"centered\" style={{ marginTop: \"18px\" }}>\n\t\t\t\t\t\t\t\t<StickerGrid mode={\"small\"}>\n\t\t\t\t\t\t\t\t\t{this.state.sticker_info.stickers}\n\t\t\t\t\t\t\t\t</StickerGrid>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</Div>\n\t\t\t\t\t</Panel>\n\t\t\t\t</View>\n\t\t\t\t<View id=\"tab_other\" activePanel={this.state.activePanelOther} popout={this.state.popout} history={this.state.historyOther} onSwipeBack={this.back} header={false}>\n\t\t\t\t\t<Panel id=\"profile\">\n\t\t\t\t\t\t<PanelHeaderSimple><PanelHeaderContent>\n\t\t\t\t\t\t\tПрофиль\n\t\t\t\t\t\t</PanelHeaderContent></PanelHeaderSimple>\n\t\t\t\t\t\t<PullToRefresh onRefresh={async () => {\n\t\t\t\t\t\t\tthis.setState({ refreshedProfile: true });\n\t\t\t\t\t\t\tlet response = await this.get('users.get');\n\t\t\t\t\t\t\tlet user_ = await bridge.sendPromise('VKWebAppGetUserInfo');\n\t\t\t\t\t\t\tthis.setState({ user: { ...user_, ...response.user } });\n\t\t\t\t\t\t\tawait this.updateUser();\n\t\t\t\t\t\t\tthis.setState({ refreshedProfile: false });\n\t\t\t\t\t\t}} isFetching={this.state.refreshedProfile}>\n\t\t\t\t\t\t\t<Div>\n\t\t\t\t\t\t\t\t<div className=\"centered\">\n\t\t\t\t\t\t\t\t\t<Avatar src={this.state.user.photo_100} size={100}/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<br/>\n\t\t\t\t\t\t\t\t<div className=\"centered\" style={{ fontSize: \"large\"}}>\n\t\t\t\t\t\t\t\t\t{this.state.user.first_name+' '+this.state.user.last_name}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<br/>\n\t\t\t\t\t\t\t\t<Group separator=\"hide\">\n\t\t\t\t\t\t\t\t\t<Cell asideContent={<Icon16Dropdown style={{ transform: `rotate(${this.state.balance_manipulation ? '180deg' : '0'})` }} />} onClick={()=> { this.setState({ balance_manipulation: !this.state.balance_manipulation }); }} indicator={this.state.user.balance+' ₽'}>Ваш баланс</Cell>\n\t\t\t\t\t\t\t\t\t{this.state.balance_manipulation && <div style={{ display: 'flex', justifyContent: 'flex-end', marginTop: '8px' }}>\n\t\t\t\t\t\t\t\t\t\t<Button size=\"l\" before={<Icon16Down/>}>Пополнить</Button>\n\t\t\t\t\t\t\t\t\t\t<Button size=\"l\" before={<Icon16Up/>} mode=\"secondary\" style={{ marginLeft: 8 }}>Вывести</Button>\n\t\t\t\t\t\t\t\t\t</div>}\n\t\t\t\t\t\t\t\t</Group>\n\t\t\t\t\t\t\t\t<Group separator=\"hide\" header={<Header mode=\"primary\">Ваши стикеры</Header>}>\n\t\t\t\t\t\t\t\t\t<div className=\"centered\" style={{ marginTop: \"18px\" }}>\n\t\t\t\t\t\t\t\t\t\t<StickerGrid mode={\"big\"}>\n\t\t\t\t\t\t\t\t\t\t\t{this.state.user_stickers}\n\t\t\t\t\t\t\t\t\t\t\t<StickerImg mode={'big'} onClick={()=> { this.go(\"create\"); }}>\n\t\t\t\t\t\t\t\t\t\t\t\t+\n\t\t\t\t\t\t\t\t\t\t\t</StickerImg>\n\t\t\t\t\t\t\t\t\t\t</StickerGrid>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</Group>\n\t\t\t\t\t\t\t</Div>\n\t\t\t\t\t\t</PullToRefresh>\n\t\t\t\t\t</Panel>\n\t\t\t\t\t<Panel id=\"create\">\n\t\t\t\t\t\t<PanelHeaderSimple>\n\t\t\t\t\t\t\t<PanelHeaderContent\n\t\t\t\t\t\t\t\taside={<Icon16Dropdown style={{ transform: `rotate(${this.state.createStickerContextOpened ? '180deg' : '0'})` }} />}\n\t\t\t\t\t\t\t\tonClick={ () => { this.toggleCreateStickerContext(); }}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tДобавить стикеры\n\t\t\t\t\t\t\t</PanelHeaderContent>\n\t\t\t\t\t\t</PanelHeaderSimple>\n\t\t\t\t\t\t<PanelHeaderContext opened={this.state.createStickerContextOpened} onClose={ () => { this.toggleCreateStickerContext(); }}>\n\t\t\t\t\t\t\t<List>\n\t\t\t\t\t\t\t\t<Cell\n\t\t\t\t\t\t\t\t\tbefore={<Icon28HistoryForwardOutline/>}\n\t\t\t\t\t\t\t\t\tonClick={ () => { this.toggleCreateStickerContext(); this.go(\"stickers_history\") }}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tИстория\n\t\t\t\t\t\t\t\t</Cell>\n\t\t\t\t\t\t\t</List>\n\t\t\t\t\t\t</PanelHeaderContext>\n\t\t\t\t\t\t<FormLayout>\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\ttop=\"Название стикер-пака\"\n\t\t\t\t\t\t\t\tname=\"title\"\n\t\t\t\t\t\t\t\tvalue={this.state.create_panel.title}\n\t\t\t\t\t\t\t\tonChange={this.onChange}\n\t\t\t\t\t\t\t\tstatus={this.state.create_panel.title ? this.state.create_panel.title.length <= 20 ? 'valid' : 'error' : 'error'}\n\t\t\t\t\t\t\t\tbottom={this.state.create_panel.title ? this.state.create_panel.title.length <= 20 ? '' : 'Максимальная длина - 20' : 'Пожалуйста, введите название'}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\ttop=\"Описание\"\n\t\t\t\t\t\t\t\tname=\"description\"\n\t\t\t\t\t\t\t\tvalue={this.state.create_panel.description}\n\t\t\t\t\t\t\t\tonChange={this.onChange}\n\t\t\t\t\t\t\t\tstatus={this.state.create_panel.description ? this.state.create_panel.description.length <= 100 ? 'valid' : 'error' : 'error'}\n\t\t\t\t\t\t\t\tbottom={this.state.create_panel.description ? this.state.create_panel.description.length <= 100 ? '' : 'Максимальная длина - 100' : 'Пожалуйста, введите описание'}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\t\ttop=\"Цена\"\n\t\t\t\t\t\t\t\tname=\"price\"\n\t\t\t\t\t\t\t\tvalue={this.state.create_panel.price}\n\t\t\t\t\t\t\t\tonChange={this.onChange}\n\t\t\t\t\t\t\t\tstatus={this.state.create_panel.price > 0 ? this.state.create_panel.price <= 1000 ? this.state.create_panel.price.toString().includes('.') ? 'error' : 'valid' : 'error' : 'error'}\n\t\t\t\t\t\t\t\tbottom={this.state.create_panel.price > 0 ? this.state.create_panel.price <= 1000 ? this.state.create_panel.price.toString().includes('.') ? 'Число должно быть целым' : '' : 'Максимальная цена- 1 000 руб.' : 'Минимальная цена - 1 руб.'}\n\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t<StickerUploadButton\n\t\t\t\t\t\t\t\tsrc={this.state.create_panel.upload_preview_img && this.state.create_panel.upload_preview_img}\n\t\t\t\t\t\t\t\ttitle={'Превью'}\n\t\t\t\t\t\t\t\tdescription={'Загрузите главную фотографию стикер-пака (128×128px)'}\n\t\t\t\t\t\t\t\tonChange={(event)=> {this.uploadFile('upload_preview_img', event)}}\n\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t<StickerUploadButton\n\t\t\t\t\t\t\t\ttitle={'Стикеры'}\n\t\t\t\t\t\t\t\tdescription={'Загрузите все стикеры (минимум - 4), которые будут содержаться в паке (128×128px)'}\n\t\t\t\t\t\t\t\tonChange={(event)=> {this.uploadFile('upload_sticker_img', event)}}\n\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t<div className=\"centered\" style={{ paddingBottom: \"16px\" }}>\n\t\t\t\t\t\t\t\t<div style={{ minWidth: \"64px\", maxWidth: \"296px\", display: \"grid\", gridTemplateColumns: \"repeat(auto-fill, 64px)\", gridGap: \"10px\" }}>\n\t\t\t\t\t\t\t\t\t{this.state.create_panel.uploaded_stickers_img}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<Button size=\"xl\" disabled={this.state.create_panel.title ? this.state.create_panel.description ? this.state.create_panel.price > 0 ? this.state.create_panel.title.length <= 20 ? this.state.create_panel.description.length <= 100 ? this.state.create_panel.price <= 1000 ? this.state.create_panel.price.toString().includes('.') ?  true : this.state.create_panel.upload_preview_img ? this.state.create_panel.uploaded_stickers_img ? this.state.create_panel.uploaded_stickers_img.filter(function(val){ return val !== undefined; }).length >= 4 ? false : true : true : true : true : true : true : true : true : true }>Продолжить</Button>\n\t\t\t\t\t\t</FormLayout>\n\t\t\t\t\t</Panel>\n\t\t\t\t\t<Panel id={\"stickers_history\"}>\n\t\t\t\t\t\t<PanelHeaderSimple><PanelHeaderContent>\n\t\t\t\t\t\t\tИстория\n\t\t\t\t\t\t</PanelHeaderContent></PanelHeaderSimple>\n\t\t\t\t\t\t{this.state.user_stickers_history && this.state.user_stickers_history.length > 0 ? <Div>\n\t\t\t\t\t\t\t<List>\n\t\t\t\t\t\t\t\t{this.state.user_stickers_history}\n\t\t\t\t\t\t\t</List>\n\t\t\t\t\t\t</Div>\n\t\t\t\t\t\t:\n\t\t\t\t\t\t\t<Placeholder\n\t\t\t\t\t\t\t\ticon={<Icon56HistoryOutline/>}\n\t\t\t\t\t\t\t\theader={'Пусто'}\n\t\t\t\t\t\t\t\tstretched\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tВы пока еще не создавали стикеры\n\t\t\t\t\t\t\t</Placeholder>}\n\t\t\t\t\t</Panel>\n\t\t\t\t</View>\n\t\t\t</Epic>\n\t\t);\n\t}\n}\n\nexport default App;"]},"metadata":{},"sourceType":"module"}