{"ast":null,"code":"import _defineProperty from\"C:\\\\Users\\\\Admin\\\\Desktop\\\\\\u041F\\u0440\\u043E\\u0435\\u043A\\u0442\\u044B\\\\NodeJS\\\\TestVKMiniApp\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _classCallCheck from\"C:\\\\Users\\\\Admin\\\\Desktop\\\\\\u041F\\u0440\\u043E\\u0435\\u043A\\u0442\\u044B\\\\NodeJS\\\\TestVKMiniApp\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\Admin\\\\Desktop\\\\\\u041F\\u0440\\u043E\\u0435\\u043A\\u0442\\u044B\\\\NodeJS\\\\TestVKMiniApp\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"C:\\\\Users\\\\Admin\\\\Desktop\\\\\\u041F\\u0440\\u043E\\u0435\\u043A\\u0442\\u044B\\\\NodeJS\\\\TestVKMiniApp\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"C:\\\\Users\\\\Admin\\\\Desktop\\\\\\u041F\\u0440\\u043E\\u0435\\u043A\\u0442\\u044B\\\\NodeJS\\\\TestVKMiniApp\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"C:\\\\Users\\\\Admin\\\\Desktop\\\\\\u041F\\u0440\\u043E\\u0435\\u043A\\u0442\\u044B\\\\NodeJS\\\\TestVKMiniApp\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:\\\\Users\\\\Admin\\\\Desktop\\\\\\u041F\\u0440\\u043E\\u0435\\u043A\\u0442\\u044B\\\\NodeJS\\\\TestVKMiniApp\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import React from'react';import Panel from'@vkontakte/vkui/dist/components/Panel/Panel';import PanelHeader from'@vkontakte/vkui/dist/components/PanelHeader/PanelHeader';import Placeholder from'@vkontakte/vkui/dist/components/Placeholder/Placeholder';import Button from'@vkontakte/vkui/dist/components/Button/Button';import Div from'@vkontakte/vkui/dist/components/Div/Div';import View from'@vkontakte/vkui/dist/components/View/View';import Avatar from'@vkontakte/vkui/dist/components/Avatar/Avatar';import Snackbar from'@vkontakte/vkui/dist/components/Snackbar/Snackbar';import ScreenSpinner from'@vkontakte/vkui/dist/components/ScreenSpinner/ScreenSpinner';import FormLayout from'@vkontakte/vkui/dist/components/FormLayout/FormLayout';import Input from'@vkontakte/vkui/dist/components/Input/Input';import Group from'@vkontakte/vkui/dist/components/Group/Group';import List from'@vkontakte/vkui/dist/components/List/List';import Cell from'@vkontakte/vkui/dist/components/Cell/Cell';import CellButton from'@vkontakte/vkui/dist/components/CellButton/CellButton';import axios from'axios';import connect from'@vkontakte/vk-connect';import Icon56InfoOutline from'@vkontakte/icons/dist/56/info_outline';import Icon16Done from'@vkontakte/icons/dist/16/done';import Icon16Cancel from'@vkontakte/icons/dist/16/cancel';import Icon24User from'@vkontakte/icons/dist/24/user';import Icon24Reply from'@vkontakte/icons/dist/24/reply';var blueBackground={backgroundColor:'var(--accent)'};var redBackground={backgroundColor:'var(--dynamic_red)'};var Home=/*#__PURE__*/function(_React$Component){_inherits(Home,_React$Component);function Home(props){var _this;_classCallCheck(this,Home);_this=_possibleConstructorReturn(this,_getPrototypeOf(Home).call(this,props));_this.state={activePanel:'main_menu',new_url:'',url_botpod:'https://oauth.vk.com/authorize?client_id=6441755&redirect_uri=https://api.vk.com/blank.html&display=page&response_type=token&revoke=1',url:'https://oauth.vk.com/authorize?client_id=2685278&redirect_uri=https://oauth.vk.com/blank.html&display=page&scope=groups,messages,friends,offline&response_type=token&v=5.64&revoke=1',popout:null,snackbar:null,user_id:0,auth_letter:'https://vk.com/@vkbts_adm-auth-letter',chats:[],allow_chats:[]};_this.openBase=_this.openBase.bind(_assertThisInitialized(_this));_this.onChange=_this.onChange.bind(_assertThisInitialized(_this));_this.send_url=_this.send_url.bind(_assertThisInitialized(_this));_this.login=_this.login.bind(_assertThisInitialized(_this));_this.logout=_this.logout.bind(_assertThisInitialized(_this));_this.componentDidMount=_this.componentDidMount.bind(_assertThisInitialized(_this));connect.send(\"VKWebAppInit\",{});return _this;}_createClass(Home,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;this.setState({popout:React.createElement(ScreenSpinner,null)});setTimeout(function(){_this2.login();},1000);}},{key:\"login\",value:function login(){var _this3=this;connect.sendPromise(\"VKWebAppGetUserInfo\",{}).then(function(data){console.log(data);_this3.setState({user_id:data.id});axios({method:'get',url:\"https://admin-chat-bot.herokuapp.com/api\",params:{method:'auth',user_id:data.id},headers:{'Content-Type':'application/json'},responseType:'json'}).then(function(response){var error=response.data.error;if(error){this.openBase(response.data.data,React.createElement(Icon16Cancel,{fill:\"#fff\",width:14,height:14}),redBackground);}else{this.setState({activePanel:'main',chats:response.data.chats});this.openBase(response.data.data,React.createElement(Icon16Done,{fill:\"#fff\",width:14,height:14}),blueBackground);}}.bind(_this3));}).catch(function(error){console.log(error);});this.setState({popout:null});}},{key:\"onChange\",value:function onChange(e){var _e$currentTarget=e.currentTarget,name=_e$currentTarget.name,value=_e$currentTarget.value;this.setState(_defineProperty({},name,value));}},{key:\"openBase\",value:function openBase(text,image,style){var _this4=this;this.setState({snackbar:null});this.setState({snackbar:React.createElement(Snackbar,{layout:\"vertical\",onClose:function onClose(){return _this4.setState({snackbar:null});},before:React.createElement(Avatar,{size:24,style:style},image)},text)});}},{key:\"logout\",value:function logout(){axios({method:'get',url:\"https://admin-chat-bot.herokuapp.com/api\",params:{method:'logout',user_id:this.state.user_id},headers:{'Content-Type':'application/json'},responseType:'json'}).then(function(response){var error=response.data.error;if(error){this.openBase(response.data.data,React.createElement(Icon16Cancel,{fill:\"#fff\",width:14,height:14}),redBackground);}else{this.setState({activePanel:'main_menu'});this.openBase(response.data.data,React.createElement(Icon16Done,{fill:\"#fff\",width:14,height:14}),blueBackground);}}.bind(this));}},{key:\"send_url\",value:function send_url(){if((this.state.new_url.includes('http')||this.state.new_url.includes('https'))&&this.state.new_url.includes('access_token')){axios({method:'get',url:\"https://admin-chat-bot.herokuapp.com/api\",params:{method:'auth',url:this.state.new_url},headers:{'Content-Type':'application/json'},responseType:'json'}).then(function(response){var error=response.data.error;if(error){this.openBase(response.data.data,React.createElement(Icon16Cancel,{fill:\"#fff\",width:14,height:14}),redBackground);}else{this.setState({activePanel:'main',new_url:''});this.openBase(response.data.data,React.createElement(Icon16Done,{fill:\"#fff\",width:14,height:14}),blueBackground);}}.bind(this));}else{this.openBase('Некорректная ссылка',React.createElement(Icon16Cancel,{fill:\"#fff\",width:14,height:14}),redBackground);}}},{key:\"render\",value:function render(){var _this5=this;var new_url=this.state.new_url.new_url;return React.createElement(View,{popout:this.state.popout},React.createElement(View,{activePanel:this.state.activePanel},React.createElement(Panel,{id:\"main_menu\"},React.createElement(PanelHeader,null,\"VK App\"),React.createElement(Placeholder,{icon:React.createElement(Icon56InfoOutline,null),title:\"\\u0410\\u0432\\u0442\\u043E\\u0440\\u0438\\u0437\\u0430\\u0446\\u0438\\u044F\",action:React.createElement(Button,{size:\"xl\",onClick:function onClick(){return _this5.setState({activePanel:'auth'});},level:\"tertiary\"},\"\\u0412\\u043E\\u0439\\u0442\\u0438\"),stretched:true},\"\\u0414\\u043B\\u044F \\u043F\\u043E\\u043B\\u0443\\u0447\\u0435\\u043D\\u0438\\u044F \\u0434\\u043E\\u0441\\u0442\\u0443\\u043F\\u0430 \\u043A\\u043E \\u0432\\u0441\\u0435\\u043C \\u0444\\u0443\\u043D\\u043A\\u0446\\u0438\\u044F\\u043C, \\u043D\\u0435\\u043E\\u0431\\u0445\\u043E\\u0434\\u0438\\u043C\\u043E \\u0430\\u0432\\u0442\\u043E\\u0440\\u0438\\u0437\\u043E\\u0432\\u0430\\u0442\\u044C\\u0441\\u044F\"),this.state.snackbar),React.createElement(Panel,{id:\"auth\",theme:\"white\"},React.createElement(PanelHeader,null,\" \\u0410\\u0432\\u0442\\u043E\\u0440\\u0438\\u0437\\u0430\\u0446\\u0438\\u044F \"),React.createElement(FormLayout,null,React.createElement(Div,null,\"\\u0427\\u0442\\u043E\\u0431\\u044B \\u0430\\u0432\\u0442\\u043E\\u0440\\u0438\\u0437\\u043E\\u0432\\u0430\\u0442\\u044C\\u0441\\u044F, \\u043F\\u0435\\u0440\\u0435\\u0439\\u0434\\u0438\\u0442\\u0435 \\u043F\\u043E \",React.createElement(\"a\",{target:\"_blank\",href:this.state.url},\"\\u0441\\u0441\\u044B\\u043B\\u043A\\u0435\"),\". \\u0414\\u0430\\u043B\\u0435\\u0435 \\u0430\\u0432\\u0442\\u043E\\u0440\\u0438\\u0437\\u0443\\u0439\\u0442\\u0435\\u0441\\u044C \\u0447\\u0435\\u0440\\u0435\\u0437 \\u0412\\u041A\\u043E\\u043D\\u0442\\u0430\\u043A\\u0442\\u0435. \\u0423 \\u0412\\u0430\\u0441 \\u0438\\u0437\\u043C\\u0435\\u043D\\u0438\\u0442\\u0441\\u044F \\u0441\\u0441\\u044B\\u043B\\u043A\\u0430 \\u0432 \\u0430\\u0434\\u0440\\u0435\\u0441\\u043D\\u043E\\u0439 \\u0441\\u0442\\u0440\\u043E\\u043A\\u0435, \\u0432\\u0441\\u0442\\u0430\\u0432\\u044C\\u0442\\u0435 \\u0435\\u0451 \\u0432 \\u043F\\u043E\\u043B\\u0435 \\u043D\\u0438\\u0436\\u0435.\"),React.createElement(Input,{top:\"\\u041D\\u043E\\u0432\\u0430\\u044F \\u0441\\u0441\\u044B\\u043B\\u043A\\u0430\",placeHolder:\"\\u041F\\u0440\\u0438\\u043C\\u0435\\u0440: https://oauth.vk.com/blank.html#access_token=abcdefg&expires_in=0&user_id=123\",name:\"new_url\",value:new_url,onChange:this.onChange}),React.createElement(Button,{size:\"xl\",onClick:this.send_url},\" \\u041F\\u0440\\u043E\\u0434\\u043E\\u043B\\u0436\\u0438\\u0442\\u044C \"),React.createElement(Button,{size:\"xl\",level:\"tertiary\"},React.createElement(\"a\",{target:\"_blank\",href:this.state.auth_letter},\" \\u0417\\u0430\\u0447\\u0435\\u043C \\u044D\\u0442\\u043E \\u043D\\u0443\\u0436\\u043D\\u043E? \"))),this.state.snackbar),React.createElement(Panel,{id:\"main\"},React.createElement(PanelHeader,null,\" \\u0413\\u043B\\u0430\\u0432\\u043D\\u0430\\u044F \"),React.createElement(Group,null,React.createElement(List,null,React.createElement(CellButton,{level:\"danger\",onClick:this.logout,before:React.createElement(Icon24Reply,null)},\"\\u0412\\u044B\\u0439\\u0442\\u0438\")),React.createElement(List,null,this.state.chats.map(function(value,i){return React.createElement(Cell,{before:React.createElement(Avatar,{src:value.photo})},value.title);}))),this.state.snackbar)));}}]);return Home;}(React.Component);export default Home;","map":{"version":3,"sources":["C:/Users/Admin/Desktop/Проекты/NodeJS/TestVKMiniApp/src/panels/Home.js"],"names":["React","Panel","PanelHeader","Placeholder","Button","Div","View","Avatar","Snackbar","ScreenSpinner","FormLayout","Input","Group","List","Cell","CellButton","axios","connect","Icon56InfoOutline","Icon16Done","Icon16Cancel","Icon24User","Icon24Reply","blueBackground","backgroundColor","redBackground","Home","props","state","activePanel","new_url","url_botpod","url","popout","snackbar","user_id","auth_letter","chats","allow_chats","openBase","bind","onChange","send_url","login","logout","componentDidMount","send","setState","setTimeout","sendPromise","then","data","console","log","id","method","params","headers","responseType","response","error","catch","e","currentTarget","name","value","text","image","style","includes","map","i","photo","title","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport Panel from '@vkontakte/vkui/dist/components/Panel/Panel';\nimport PanelHeader from '@vkontakte/vkui/dist/components/PanelHeader/PanelHeader';\nimport Placeholder from '@vkontakte/vkui/dist/components/Placeholder/Placeholder';\nimport Button from '@vkontakte/vkui/dist/components/Button/Button';\nimport Div from '@vkontakte/vkui/dist/components/Div/Div';\nimport View from '@vkontakte/vkui/dist/components/View/View';\nimport Avatar from '@vkontakte/vkui/dist/components/Avatar/Avatar';\nimport Snackbar from '@vkontakte/vkui/dist/components/Snackbar/Snackbar';\nimport ScreenSpinner from '@vkontakte/vkui/dist/components/ScreenSpinner/ScreenSpinner';\nimport FormLayout from '@vkontakte/vkui/dist/components/FormLayout/FormLayout';\nimport Input from '@vkontakte/vkui/dist/components/Input/Input';\nimport Group from '@vkontakte/vkui/dist/components/Group/Group';\nimport List from '@vkontakte/vkui/dist/components/List/List';\nimport Cell from '@vkontakte/vkui/dist/components/Cell/Cell';\nimport CellButton from '@vkontakte/vkui/dist/components/CellButton/CellButton';\n\nimport axios from 'axios';\nimport connect from '@vkontakte/vk-connect';\n\nimport Icon56InfoOutline from '@vkontakte/icons/dist/56/info_outline';\nimport Icon16Done from '@vkontakte/icons/dist/16/done';\nimport Icon16Cancel from '@vkontakte/icons/dist/16/cancel';\nimport Icon24User from '@vkontakte/icons/dist/24/user';\nimport Icon24Reply from '@vkontakte/icons/dist/24/reply';\n\nconst blueBackground = {\n  backgroundColor: 'var(--accent)'\n};\n\nconst redBackground = {\n  backgroundColor: 'var(--dynamic_red)'\n};\n\nclass Home extends React.Component {\n\t\n\tconstructor(props) {\n\t\tsuper(props);\n\t\n\t\tthis.state = {\n\t\t\tactivePanel: 'main_menu',\n\t\t\tnew_url: '',\n\t\t\turl_botpod: 'https://oauth.vk.com/authorize?client_id=6441755&redirect_uri=https://api.vk.com/blank.html&display=page&response_type=token&revoke=1',\n\t\t\turl: 'https://oauth.vk.com/authorize?client_id=2685278&redirect_uri=https://oauth.vk.com/blank.html&display=page&scope=groups,messages,friends,offline&response_type=token&v=5.64&revoke=1',\n\t\t\tpopout: null,\n\t\t\tsnackbar: null,\n\t\t\tuser_id: 0,\n\t\t\tauth_letter: 'https://vk.com/@vkbts_adm-auth-letter',\n\t\t\tchats: [],\n\t\t\tallow_chats: [],\n\t\t};\n\t\t\n\t\tthis.openBase = this.openBase.bind(this);\n\t\tthis.onChange = this.onChange.bind(this);\n\t\tthis.send_url = this.send_url.bind(this);\n\t\tthis.login = this.login.bind(this);\n\t\tthis.logout = this.logout.bind(this);\n\t\tthis.componentDidMount = this.componentDidMount.bind(this);\n\t\t\n\t\tconnect.send(\"VKWebAppInit\", {});\n\t}\n\t\n\tcomponentDidMount () {\n\t\tthis.setState({ popout: <ScreenSpinner /> });\n\t\tsetTimeout(() => { this.login() }, 1000);\n\t}\n\t\n\tlogin() {\n\t\tconnect.sendPromise(\"VKWebAppGetUserInfo\", {})\n\t\t\t.then(data => {\n\t\t\t\tconsole.log(data);\n\t\t\t\tthis.setState({ user_id: data.id });\n\t\t\t\taxios({\n\t\t\t\t\tmethod: 'get',\n\t\t\t\t\turl: \"https://admin-chat-bot.herokuapp.com/api\",\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tmethod: 'auth',\n\t\t\t\t\t\tuser_id: data.id\n\t\t\t\t\t},\n\t\t\t\t\theaders: {'Content-Type': 'application/json'},\n\t\t\t\t\tresponseType: 'json'\n\t\t\t\t}).then(function (response) {\n\t\t\t\t\tvar error = response.data.error;\n\t\t\t\t\tif(error){\n\t\t\t\t\t\tthis.openBase(response.data.data, <Icon16Cancel fill=\"#fff\" width={14} height={14} />, redBackground);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis.setState({ activePanel: 'main', chats: response.data.chats });\n\t\t\t\t\t\tthis.openBase(response.data.data, <Icon16Done fill=\"#fff\" width={14} height={14} />, blueBackground);\n\t\t\t\t\t}\n\t\t\t\t}.bind(this));\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tconsole.log(error);\n\t\t\t});\n\t\tthis.setState({ popout: null });\n\t}\n\t\n\tonChange(e) {\n\t\tconst { name, value } = e.currentTarget;\n\t\tthis.setState({ [name]: value });\n\t}\n\t\n\topenBase (text, image, style) {\n\t\tthis.setState({ snackbar: null });\n\t\tthis.setState({ snackbar:\n\t\t<Snackbar\n\t\t\tlayout=\"vertical\"\n\t\t\tonClose={() => this.setState({ snackbar: null })}\n\t\t\tbefore={<Avatar size={24} style={style}>{image}</Avatar>}\n\t\t>\n\t\t{text}\n\t\t</Snackbar>\n\t\t});\n\t}\n\t\n\tlogout() {\n\t\taxios({\n\t\t\t\tmethod: 'get',\n\t\t\t\turl: \"https://admin-chat-bot.herokuapp.com/api\",\n\t\t\t\tparams: {\n\t\t\t\t\tmethod: 'logout',\n\t\t\t\t\tuser_id: this.state.user_id\n\t\t\t\t},\n\t\t\t\theaders: {'Content-Type': 'application/json'},\n\t\t\t\tresponseType: 'json'\n\t\t\t}).then(function (response) {\n\t\t\t\tvar error = response.data.error;\n\t\t\t\tif(error){\n\t\t\t\t\tthis.openBase(response.data.data, <Icon16Cancel fill=\"#fff\" width={14} height={14} />, redBackground);\n\t\t\t\t}else{\n\t\t\t\t\tthis.setState({ activePanel: 'main_menu' });\n\t\t\t\t\tthis.openBase(response.data.data, <Icon16Done fill=\"#fff\" width={14} height={14} />, blueBackground);\n\t\t\t\t}\n\t\t\t}.bind(this));\n\t}\n\t\n\tsend_url () {\n\t\tif( ( this.state.new_url.includes('http') || this.state.new_url.includes('https') ) && this.state.new_url.includes('access_token') ){\n\t\t\taxios({\n\t\t\t\tmethod: 'get',\n\t\t\t\turl: \"https://admin-chat-bot.herokuapp.com/api\",\n\t\t\t\tparams: {\n\t\t\t\t\tmethod: 'auth',\n\t\t\t\t\turl: this.state.new_url\n\t\t\t\t},\n\t\t\t\theaders: {'Content-Type': 'application/json'},\n\t\t\t\tresponseType: 'json'\n\t\t\t}).then(function (response) {\n\t\t\t\tvar error = response.data.error;\n\t\t\t\tif(error){\n\t\t\t\t\tthis.openBase(response.data.data, <Icon16Cancel fill=\"#fff\" width={14} height={14} />, redBackground);\n\t\t\t\t}else{\n\t\t\t\t\tthis.setState({ activePanel: 'main', new_url: '' });\n\t\t\t\t\tthis.openBase(response.data.data, <Icon16Done fill=\"#fff\" width={14} height={14} />, blueBackground);\n\t\t\t\t}\n\t\t\t}.bind(this));\n\t\t}else{\n\t\t\tthis.openBase('Некорректная ссылка', <Icon16Cancel fill=\"#fff\" width={14} height={14} />, redBackground);\n\t\t}\n\t} \n\t\n\trender() {\n\t\tconst { new_url } = this.state.new_url;\n\t\treturn (\n\t\t<View popout={this.state.popout}>\n\t\t<View activePanel={this.state.activePanel}>\n\t\t\t<Panel id=\"main_menu\">\n\t\t\t\t<PanelHeader>VK App</PanelHeader>\n\t\t\t\n\t\t\t\t<Placeholder\n\t\t\t\t\ticon={<Icon56InfoOutline />}\n\t\t\t\t\ttitle=\"Авторизация\"\n\t\t\t\t\taction={<Button size=\"xl\" onClick={ () => this.setState({ activePanel: 'auth' }) } level=\"tertiary\">Войти</Button>}\n\t\t\t\t\tstretched\n\t\t\t\t>\n\t\t\t\t\tДля получения доступа ко всем функциям, необходимо авторизоваться\n\t\t\t\t</Placeholder>\n\t\t\t\t{this.state.snackbar}\n\t\t\t</Panel>\n\t\t\t\n\t\t\t<Panel id=\"auth\" theme=\"white\" >\n\t\t\t\t<PanelHeader> Авторизация </PanelHeader>\n\t\t\t\t<FormLayout>\n\t\t\t\t\t<Div>\n\t\t\t\t\tЧтобы авторизоваться, перейдите по <a target='_blank' href={this.state.url}>ссылке</a>. Далее авторизуйтесь через ВКонтакте.\n\t\t\t\t\tУ Вас изменится ссылка в адресной строке, вставьте её в поле ниже.</Div>\n\t\t\t\t\t\n\t\t\t\t\t<Input\n\t\t\t\t\t\ttop = \"Новая ссылка\"\n\t\t\t\t\t\tplaceHolder =\"Пример: https://oauth.vk.com/blank.html#access_token=abcdefg&expires_in=0&user_id=123\"\n\t\t\t\t\t\tname=\"new_url\"\n\t\t\t\t\t\tvalue={new_url}\n\t\t\t\t\t\tonChange={this.onChange}\n\t\t\t\t\t/>\n\t\t\t\t\n\t\t\t\t\t<Button size=\"xl\" onClick={this.send_url}> Продолжить </Button>\n\t\t\t\t\t\n\t\t\t\t\t<Button size=\"xl\" level=\"tertiary\"><a target='_blank' href={this.state.auth_letter}> Зачем это нужно? </a></Button>\n\t\t\t\t\t\n\t\t\t\t</FormLayout>\n\t\t\t\t{this.state.snackbar}\n\t\t\t</Panel>\n\t\t\t\n\t\t\t<Panel id=\"main\">\n\t\t\t\t<PanelHeader> Главная </PanelHeader>\n\t\t\t\t<Group>\n\t\t\t\t\t<List>\n\t\t\t\t\t\t<CellButton level=\"danger\" onClick={this.logout} before={<Icon24Reply />}>Выйти</CellButton>\n\t\t\t\t\t</List>\n\t\t\t\t\t\n\t\t\t\t\t<List>\n\t\t\t\t\t\t{this.state.chats.map((value, i) => \n\t\t\t\t\t\t<Cell before={<Avatar src={value.photo} />}>{value.title}</Cell>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t\n\t\t\t\t\t</List>\n\t\t\t\t\t\n\t\t\t\t</Group>\n\t\t\t\t{this.state.snackbar}\n\t\t\t</Panel>\n\t\t</View>\n\t\t</View>\n\t\t);\n\t}\n}\n\nHome.propTypes = {\n\tid: PropTypes.string.isRequired,\n\tgo: PropTypes.func.isRequired,\n};\n\nexport default Home;\n"]},"metadata":{},"sourceType":"module"}